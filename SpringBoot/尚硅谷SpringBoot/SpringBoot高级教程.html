<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBoot的高级教程 | zouyu-Blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/blog/images/learn.png">
    <meta name="description" content="求知若渴，虚心若愚。 愿你每天都在成长">
    
    <link rel="preload" href="/blog/assets/css/0.styles.b6bbc000.css" as="style"><link rel="preload" href="/blog/assets/js/app.5c484a50.js" as="script"><link rel="preload" href="/blog/assets/js/3.8dc6c122.js" as="script"><link rel="preload" href="/blog/assets/js/426.50769ad5.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.febbc81f.js"><link rel="prefetch" href="/blog/assets/js/100.9259ef63.js"><link rel="prefetch" href="/blog/assets/js/101.3da27d21.js"><link rel="prefetch" href="/blog/assets/js/102.6fa069ad.js"><link rel="prefetch" href="/blog/assets/js/103.43e9f62f.js"><link rel="prefetch" href="/blog/assets/js/104.6f86dc9e.js"><link rel="prefetch" href="/blog/assets/js/105.4a19bfc6.js"><link rel="prefetch" href="/blog/assets/js/106.e05fe0f9.js"><link rel="prefetch" href="/blog/assets/js/107.9742ed05.js"><link rel="prefetch" href="/blog/assets/js/108.2c8f6f4e.js"><link rel="prefetch" href="/blog/assets/js/109.3b96b505.js"><link rel="prefetch" href="/blog/assets/js/11.6c44e9c9.js"><link rel="prefetch" href="/blog/assets/js/110.3428e3da.js"><link rel="prefetch" href="/blog/assets/js/111.f1864178.js"><link rel="prefetch" href="/blog/assets/js/112.2ef1a6cc.js"><link rel="prefetch" href="/blog/assets/js/113.663107aa.js"><link rel="prefetch" href="/blog/assets/js/114.27ae3724.js"><link rel="prefetch" href="/blog/assets/js/115.da0b4d3a.js"><link rel="prefetch" href="/blog/assets/js/116.fbe6dcd2.js"><link rel="prefetch" href="/blog/assets/js/117.bf1d0b1a.js"><link rel="prefetch" href="/blog/assets/js/118.ac660281.js"><link rel="prefetch" href="/blog/assets/js/119.f381212e.js"><link rel="prefetch" href="/blog/assets/js/12.f16fe947.js"><link rel="prefetch" href="/blog/assets/js/120.d4e55d8d.js"><link rel="prefetch" href="/blog/assets/js/121.bb88ab51.js"><link rel="prefetch" href="/blog/assets/js/122.651f365e.js"><link rel="prefetch" href="/blog/assets/js/123.13ea0580.js"><link rel="prefetch" href="/blog/assets/js/124.6f849caf.js"><link rel="prefetch" href="/blog/assets/js/125.64fd3346.js"><link rel="prefetch" href="/blog/assets/js/126.dac1aa2e.js"><link rel="prefetch" href="/blog/assets/js/127.f9776ae0.js"><link rel="prefetch" href="/blog/assets/js/128.60667ffd.js"><link rel="prefetch" href="/blog/assets/js/129.4e3188ff.js"><link rel="prefetch" href="/blog/assets/js/13.b299c7b1.js"><link rel="prefetch" href="/blog/assets/js/130.714850ba.js"><link rel="prefetch" href="/blog/assets/js/131.0d15a4db.js"><link rel="prefetch" href="/blog/assets/js/132.7f8418d0.js"><link rel="prefetch" href="/blog/assets/js/133.1c5d88c7.js"><link rel="prefetch" href="/blog/assets/js/134.74ba0012.js"><link rel="prefetch" href="/blog/assets/js/135.11ec9e17.js"><link rel="prefetch" href="/blog/assets/js/136.d5e724ce.js"><link rel="prefetch" href="/blog/assets/js/137.bfadad53.js"><link rel="prefetch" href="/blog/assets/js/138.0d07a873.js"><link rel="prefetch" href="/blog/assets/js/139.6a2b3a93.js"><link rel="prefetch" href="/blog/assets/js/14.67fbf28f.js"><link rel="prefetch" href="/blog/assets/js/140.c34f86ef.js"><link rel="prefetch" href="/blog/assets/js/141.3ff0a6ed.js"><link rel="prefetch" href="/blog/assets/js/142.55be366b.js"><link rel="prefetch" href="/blog/assets/js/143.583f3dc6.js"><link rel="prefetch" href="/blog/assets/js/144.a88b6453.js"><link rel="prefetch" href="/blog/assets/js/145.966eae27.js"><link rel="prefetch" href="/blog/assets/js/146.d5da85c2.js"><link rel="prefetch" href="/blog/assets/js/147.96ff5977.js"><link rel="prefetch" href="/blog/assets/js/148.d9973f2d.js"><link rel="prefetch" href="/blog/assets/js/149.f13607c8.js"><link rel="prefetch" href="/blog/assets/js/15.b3e3f322.js"><link rel="prefetch" href="/blog/assets/js/150.50f22aa4.js"><link rel="prefetch" href="/blog/assets/js/151.6c8353f7.js"><link rel="prefetch" href="/blog/assets/js/152.4c15de81.js"><link rel="prefetch" href="/blog/assets/js/153.67297978.js"><link rel="prefetch" href="/blog/assets/js/154.123b78de.js"><link rel="prefetch" href="/blog/assets/js/155.2102ec2d.js"><link rel="prefetch" href="/blog/assets/js/156.3882f181.js"><link rel="prefetch" href="/blog/assets/js/157.685eca62.js"><link rel="prefetch" href="/blog/assets/js/158.9a955ef1.js"><link rel="prefetch" href="/blog/assets/js/159.dbd351c7.js"><link rel="prefetch" href="/blog/assets/js/16.c97a8088.js"><link rel="prefetch" href="/blog/assets/js/160.45a18a5c.js"><link rel="prefetch" href="/blog/assets/js/161.e2497d2b.js"><link rel="prefetch" href="/blog/assets/js/162.8377780a.js"><link rel="prefetch" href="/blog/assets/js/163.ae45f0a5.js"><link rel="prefetch" href="/blog/assets/js/164.6df8087d.js"><link rel="prefetch" href="/blog/assets/js/165.3f6123e3.js"><link rel="prefetch" href="/blog/assets/js/166.e7c96a06.js"><link rel="prefetch" href="/blog/assets/js/167.6030d2c9.js"><link rel="prefetch" href="/blog/assets/js/168.4286e6b2.js"><link rel="prefetch" href="/blog/assets/js/169.d4a167a8.js"><link rel="prefetch" href="/blog/assets/js/17.6cc239d7.js"><link rel="prefetch" href="/blog/assets/js/170.3ba6ab29.js"><link rel="prefetch" href="/blog/assets/js/171.188d2f49.js"><link rel="prefetch" href="/blog/assets/js/172.2466b9d8.js"><link rel="prefetch" href="/blog/assets/js/173.c84b34de.js"><link rel="prefetch" href="/blog/assets/js/174.cb219705.js"><link rel="prefetch" href="/blog/assets/js/175.9316fb59.js"><link rel="prefetch" href="/blog/assets/js/176.36d208a2.js"><link rel="prefetch" href="/blog/assets/js/177.c47c9a81.js"><link rel="prefetch" href="/blog/assets/js/178.51aee8c2.js"><link rel="prefetch" href="/blog/assets/js/179.4a4a372e.js"><link rel="prefetch" href="/blog/assets/js/18.dcbf7d0d.js"><link rel="prefetch" href="/blog/assets/js/180.5b7b3672.js"><link rel="prefetch" href="/blog/assets/js/181.d9cf5f99.js"><link rel="prefetch" href="/blog/assets/js/182.c2635527.js"><link rel="prefetch" href="/blog/assets/js/183.a44ae4fe.js"><link rel="prefetch" href="/blog/assets/js/184.194d8640.js"><link rel="prefetch" href="/blog/assets/js/185.bc5d30a9.js"><link rel="prefetch" href="/blog/assets/js/186.eff8552b.js"><link rel="prefetch" href="/blog/assets/js/187.5d951aeb.js"><link rel="prefetch" href="/blog/assets/js/188.5c1223fa.js"><link rel="prefetch" href="/blog/assets/js/189.5808866f.js"><link rel="prefetch" href="/blog/assets/js/19.2140c229.js"><link rel="prefetch" href="/blog/assets/js/190.994c47f6.js"><link rel="prefetch" href="/blog/assets/js/191.959d5f5f.js"><link rel="prefetch" href="/blog/assets/js/192.b5a07fb6.js"><link rel="prefetch" href="/blog/assets/js/193.311be80e.js"><link rel="prefetch" href="/blog/assets/js/194.82453715.js"><link rel="prefetch" href="/blog/assets/js/195.ff6d8d1d.js"><link rel="prefetch" href="/blog/assets/js/196.5c8e3b0a.js"><link rel="prefetch" href="/blog/assets/js/197.ef0327ec.js"><link rel="prefetch" href="/blog/assets/js/198.3cdb7156.js"><link rel="prefetch" href="/blog/assets/js/199.5c27985a.js"><link rel="prefetch" href="/blog/assets/js/2.1e74d1b7.js"><link rel="prefetch" href="/blog/assets/js/20.d0ed9959.js"><link rel="prefetch" href="/blog/assets/js/200.3456f9ed.js"><link rel="prefetch" href="/blog/assets/js/201.9d75fd1b.js"><link rel="prefetch" href="/blog/assets/js/202.857fb3c0.js"><link rel="prefetch" href="/blog/assets/js/203.7e9c5613.js"><link rel="prefetch" href="/blog/assets/js/204.b8b5fecf.js"><link rel="prefetch" href="/blog/assets/js/205.e94357c3.js"><link rel="prefetch" href="/blog/assets/js/206.241ec95d.js"><link rel="prefetch" href="/blog/assets/js/207.396b4219.js"><link rel="prefetch" href="/blog/assets/js/208.af2e1487.js"><link rel="prefetch" href="/blog/assets/js/209.b51b3443.js"><link rel="prefetch" href="/blog/assets/js/21.b25258d9.js"><link rel="prefetch" href="/blog/assets/js/210.7c7e4e9a.js"><link rel="prefetch" href="/blog/assets/js/211.6ce7171d.js"><link rel="prefetch" href="/blog/assets/js/212.5b57621d.js"><link rel="prefetch" href="/blog/assets/js/213.6ff1fe81.js"><link rel="prefetch" href="/blog/assets/js/214.79574d36.js"><link rel="prefetch" href="/blog/assets/js/215.5f478880.js"><link rel="prefetch" href="/blog/assets/js/216.f1990223.js"><link rel="prefetch" href="/blog/assets/js/217.4f0002d6.js"><link rel="prefetch" href="/blog/assets/js/218.1ebb365c.js"><link rel="prefetch" href="/blog/assets/js/219.e895b4b4.js"><link rel="prefetch" href="/blog/assets/js/22.10048574.js"><link rel="prefetch" href="/blog/assets/js/220.0bde54b7.js"><link rel="prefetch" href="/blog/assets/js/221.40d18f8d.js"><link rel="prefetch" href="/blog/assets/js/222.de2d8c15.js"><link rel="prefetch" href="/blog/assets/js/223.98359f1d.js"><link rel="prefetch" href="/blog/assets/js/224.10eb7b02.js"><link rel="prefetch" href="/blog/assets/js/225.bbc28cd7.js"><link rel="prefetch" href="/blog/assets/js/226.d956a74e.js"><link rel="prefetch" href="/blog/assets/js/227.698f6ee6.js"><link rel="prefetch" href="/blog/assets/js/228.63ee50cc.js"><link rel="prefetch" href="/blog/assets/js/229.b9f12d0e.js"><link rel="prefetch" href="/blog/assets/js/23.736c36fb.js"><link rel="prefetch" href="/blog/assets/js/230.160989ee.js"><link rel="prefetch" href="/blog/assets/js/231.e9fc614f.js"><link rel="prefetch" href="/blog/assets/js/232.09680974.js"><link rel="prefetch" href="/blog/assets/js/233.0b65fbee.js"><link rel="prefetch" href="/blog/assets/js/234.812382ac.js"><link rel="prefetch" href="/blog/assets/js/235.96ed847d.js"><link rel="prefetch" href="/blog/assets/js/236.1b7d21d9.js"><link rel="prefetch" href="/blog/assets/js/237.fd37c628.js"><link rel="prefetch" href="/blog/assets/js/238.b0a306e1.js"><link rel="prefetch" href="/blog/assets/js/239.29816201.js"><link rel="prefetch" href="/blog/assets/js/24.328221fb.js"><link rel="prefetch" href="/blog/assets/js/240.27ff7069.js"><link rel="prefetch" href="/blog/assets/js/241.d209581a.js"><link rel="prefetch" href="/blog/assets/js/242.4c9ff8ec.js"><link rel="prefetch" href="/blog/assets/js/243.977d4f2e.js"><link rel="prefetch" href="/blog/assets/js/244.a8efd7cb.js"><link rel="prefetch" href="/blog/assets/js/245.ef45f9be.js"><link rel="prefetch" href="/blog/assets/js/246.7f700f85.js"><link rel="prefetch" href="/blog/assets/js/247.df65ebb7.js"><link rel="prefetch" href="/blog/assets/js/248.197a8ac5.js"><link rel="prefetch" href="/blog/assets/js/249.bfda2705.js"><link rel="prefetch" href="/blog/assets/js/25.0ee891e6.js"><link rel="prefetch" href="/blog/assets/js/250.050376cc.js"><link rel="prefetch" href="/blog/assets/js/251.60cab832.js"><link rel="prefetch" href="/blog/assets/js/252.95d834d4.js"><link rel="prefetch" href="/blog/assets/js/253.42d40bc3.js"><link rel="prefetch" href="/blog/assets/js/254.1bde8cd1.js"><link rel="prefetch" href="/blog/assets/js/255.896d172a.js"><link rel="prefetch" href="/blog/assets/js/256.fe03a501.js"><link rel="prefetch" href="/blog/assets/js/257.5e4bc841.js"><link rel="prefetch" href="/blog/assets/js/258.2b9e8d1e.js"><link rel="prefetch" href="/blog/assets/js/259.d930ddfd.js"><link rel="prefetch" href="/blog/assets/js/26.c848430e.js"><link rel="prefetch" href="/blog/assets/js/260.1a7df354.js"><link rel="prefetch" href="/blog/assets/js/261.5ae465e5.js"><link rel="prefetch" href="/blog/assets/js/262.1301e18f.js"><link rel="prefetch" href="/blog/assets/js/263.e8152983.js"><link rel="prefetch" href="/blog/assets/js/264.54763d42.js"><link rel="prefetch" href="/blog/assets/js/265.197e4ff1.js"><link rel="prefetch" href="/blog/assets/js/266.5bb41ca7.js"><link rel="prefetch" href="/blog/assets/js/267.4ccc2952.js"><link rel="prefetch" href="/blog/assets/js/268.6c55874d.js"><link rel="prefetch" href="/blog/assets/js/269.16d4a1b6.js"><link rel="prefetch" href="/blog/assets/js/27.5ca08dc3.js"><link rel="prefetch" href="/blog/assets/js/270.062302a3.js"><link rel="prefetch" href="/blog/assets/js/271.f468a365.js"><link rel="prefetch" href="/blog/assets/js/272.7475f532.js"><link rel="prefetch" href="/blog/assets/js/273.0d63a7c5.js"><link rel="prefetch" href="/blog/assets/js/274.578eba27.js"><link rel="prefetch" href="/blog/assets/js/275.1f15360b.js"><link rel="prefetch" href="/blog/assets/js/276.f88b5eb0.js"><link rel="prefetch" href="/blog/assets/js/277.fbd7bc5a.js"><link rel="prefetch" href="/blog/assets/js/278.5aa0b66a.js"><link rel="prefetch" href="/blog/assets/js/279.37efe52d.js"><link rel="prefetch" href="/blog/assets/js/28.a492c74d.js"><link rel="prefetch" href="/blog/assets/js/280.08d98529.js"><link rel="prefetch" href="/blog/assets/js/281.10153dc3.js"><link rel="prefetch" href="/blog/assets/js/282.e5f74d64.js"><link rel="prefetch" href="/blog/assets/js/283.5c392061.js"><link rel="prefetch" href="/blog/assets/js/284.66399a0d.js"><link rel="prefetch" href="/blog/assets/js/285.5dc7dced.js"><link rel="prefetch" href="/blog/assets/js/286.7472a08f.js"><link rel="prefetch" href="/blog/assets/js/287.e3cdd175.js"><link rel="prefetch" href="/blog/assets/js/288.21067c33.js"><link rel="prefetch" href="/blog/assets/js/289.9e36a862.js"><link rel="prefetch" href="/blog/assets/js/29.eadbb91b.js"><link rel="prefetch" href="/blog/assets/js/290.21ac81c4.js"><link rel="prefetch" href="/blog/assets/js/291.de3f0b07.js"><link rel="prefetch" href="/blog/assets/js/292.91f191d1.js"><link rel="prefetch" href="/blog/assets/js/293.f48c5e4c.js"><link rel="prefetch" href="/blog/assets/js/294.f56eb1aa.js"><link rel="prefetch" href="/blog/assets/js/295.6ff86e37.js"><link rel="prefetch" href="/blog/assets/js/296.251d0cf1.js"><link rel="prefetch" href="/blog/assets/js/297.72ae5fbc.js"><link rel="prefetch" href="/blog/assets/js/298.912a5770.js"><link rel="prefetch" href="/blog/assets/js/299.c4c3b63b.js"><link rel="prefetch" href="/blog/assets/js/30.146ee850.js"><link rel="prefetch" href="/blog/assets/js/300.648c3383.js"><link rel="prefetch" href="/blog/assets/js/301.f1fd0ccc.js"><link rel="prefetch" href="/blog/assets/js/302.f7ac91ee.js"><link rel="prefetch" href="/blog/assets/js/303.f50c769e.js"><link rel="prefetch" href="/blog/assets/js/304.5a5924f1.js"><link rel="prefetch" href="/blog/assets/js/305.e78109af.js"><link rel="prefetch" href="/blog/assets/js/306.09a00b3d.js"><link rel="prefetch" href="/blog/assets/js/307.9fa922a5.js"><link rel="prefetch" href="/blog/assets/js/308.74419bea.js"><link rel="prefetch" href="/blog/assets/js/309.2c51491a.js"><link rel="prefetch" href="/blog/assets/js/31.80988661.js"><link rel="prefetch" href="/blog/assets/js/310.156ccd31.js"><link rel="prefetch" href="/blog/assets/js/311.069f1117.js"><link rel="prefetch" href="/blog/assets/js/312.6d459ca6.js"><link rel="prefetch" href="/blog/assets/js/313.6ae7fe1a.js"><link rel="prefetch" href="/blog/assets/js/314.3b47135c.js"><link rel="prefetch" href="/blog/assets/js/315.cba18b5b.js"><link rel="prefetch" href="/blog/assets/js/316.8d67ceb3.js"><link rel="prefetch" href="/blog/assets/js/317.31350d67.js"><link rel="prefetch" href="/blog/assets/js/318.29ad7071.js"><link rel="prefetch" href="/blog/assets/js/319.398d5045.js"><link rel="prefetch" href="/blog/assets/js/32.5a199b69.js"><link rel="prefetch" href="/blog/assets/js/320.b662d484.js"><link rel="prefetch" href="/blog/assets/js/321.b8a7b6e7.js"><link rel="prefetch" href="/blog/assets/js/322.8b0b5761.js"><link rel="prefetch" href="/blog/assets/js/323.4e6ceee7.js"><link rel="prefetch" href="/blog/assets/js/324.65d73c42.js"><link rel="prefetch" href="/blog/assets/js/325.dcbdeae1.js"><link rel="prefetch" href="/blog/assets/js/326.b22c3dfa.js"><link rel="prefetch" href="/blog/assets/js/327.f142e908.js"><link rel="prefetch" href="/blog/assets/js/328.253a21bb.js"><link rel="prefetch" href="/blog/assets/js/329.106d8581.js"><link rel="prefetch" href="/blog/assets/js/33.e7686e07.js"><link rel="prefetch" href="/blog/assets/js/330.529ff8ac.js"><link rel="prefetch" href="/blog/assets/js/331.37cc7ff0.js"><link rel="prefetch" href="/blog/assets/js/332.e9317511.js"><link rel="prefetch" href="/blog/assets/js/333.b5c7e46a.js"><link rel="prefetch" href="/blog/assets/js/334.2009974e.js"><link rel="prefetch" href="/blog/assets/js/335.bca289ec.js"><link rel="prefetch" href="/blog/assets/js/336.84f1154d.js"><link rel="prefetch" href="/blog/assets/js/337.8c97064c.js"><link rel="prefetch" href="/blog/assets/js/338.1d5c1357.js"><link rel="prefetch" href="/blog/assets/js/339.404240c7.js"><link rel="prefetch" href="/blog/assets/js/34.289f8b30.js"><link rel="prefetch" href="/blog/assets/js/340.024ff1f2.js"><link rel="prefetch" href="/blog/assets/js/341.1dee3e73.js"><link rel="prefetch" href="/blog/assets/js/342.e3a8d2f6.js"><link rel="prefetch" href="/blog/assets/js/343.de456d93.js"><link rel="prefetch" href="/blog/assets/js/344.5238d738.js"><link rel="prefetch" href="/blog/assets/js/345.74b731be.js"><link rel="prefetch" href="/blog/assets/js/346.4e4f49af.js"><link rel="prefetch" href="/blog/assets/js/347.2a4e7e0f.js"><link rel="prefetch" href="/blog/assets/js/348.3e73ee18.js"><link rel="prefetch" href="/blog/assets/js/349.d5f7a56f.js"><link rel="prefetch" href="/blog/assets/js/35.37abd4f4.js"><link rel="prefetch" href="/blog/assets/js/350.77e69f81.js"><link rel="prefetch" href="/blog/assets/js/351.dba0ef29.js"><link rel="prefetch" href="/blog/assets/js/352.750cf699.js"><link rel="prefetch" href="/blog/assets/js/353.f3be4eb7.js"><link rel="prefetch" href="/blog/assets/js/354.6b2a2669.js"><link rel="prefetch" href="/blog/assets/js/355.70868e6b.js"><link rel="prefetch" href="/blog/assets/js/356.0cc39cff.js"><link rel="prefetch" href="/blog/assets/js/357.2ee9aae8.js"><link rel="prefetch" href="/blog/assets/js/358.5b1c11e7.js"><link rel="prefetch" href="/blog/assets/js/359.a8b6bea3.js"><link rel="prefetch" href="/blog/assets/js/36.26eafdd6.js"><link rel="prefetch" href="/blog/assets/js/360.6ed495e2.js"><link rel="prefetch" href="/blog/assets/js/361.c101b410.js"><link rel="prefetch" href="/blog/assets/js/362.24750cde.js"><link rel="prefetch" href="/blog/assets/js/363.020c769d.js"><link rel="prefetch" href="/blog/assets/js/364.7523327f.js"><link rel="prefetch" href="/blog/assets/js/365.92f2559d.js"><link rel="prefetch" href="/blog/assets/js/366.ba082027.js"><link rel="prefetch" href="/blog/assets/js/367.4bdbca64.js"><link rel="prefetch" href="/blog/assets/js/368.79daafc9.js"><link rel="prefetch" href="/blog/assets/js/369.bb30cda0.js"><link rel="prefetch" href="/blog/assets/js/37.8c46f75a.js"><link rel="prefetch" href="/blog/assets/js/370.1cd1987a.js"><link rel="prefetch" href="/blog/assets/js/371.081732d4.js"><link rel="prefetch" href="/blog/assets/js/372.67807a93.js"><link rel="prefetch" href="/blog/assets/js/373.133b4c91.js"><link rel="prefetch" href="/blog/assets/js/374.a96fbb80.js"><link rel="prefetch" href="/blog/assets/js/375.ce2e2a09.js"><link rel="prefetch" href="/blog/assets/js/376.1acbe8f3.js"><link rel="prefetch" href="/blog/assets/js/377.6011b78c.js"><link rel="prefetch" href="/blog/assets/js/378.9411f001.js"><link rel="prefetch" href="/blog/assets/js/379.fc197684.js"><link rel="prefetch" href="/blog/assets/js/38.8036c832.js"><link rel="prefetch" href="/blog/assets/js/380.e682b0f7.js"><link rel="prefetch" href="/blog/assets/js/381.0150670b.js"><link rel="prefetch" href="/blog/assets/js/382.a2a73140.js"><link rel="prefetch" href="/blog/assets/js/383.67492a6d.js"><link rel="prefetch" href="/blog/assets/js/384.0c156684.js"><link rel="prefetch" href="/blog/assets/js/385.7a674006.js"><link rel="prefetch" href="/blog/assets/js/386.7db443e2.js"><link rel="prefetch" href="/blog/assets/js/387.861fc2ad.js"><link rel="prefetch" href="/blog/assets/js/388.53293f8b.js"><link rel="prefetch" href="/blog/assets/js/389.83de2a5a.js"><link rel="prefetch" href="/blog/assets/js/39.1fcc887a.js"><link rel="prefetch" href="/blog/assets/js/390.1b032dee.js"><link rel="prefetch" href="/blog/assets/js/391.5409d13c.js"><link rel="prefetch" href="/blog/assets/js/392.95ee1817.js"><link rel="prefetch" href="/blog/assets/js/393.bfbb4e02.js"><link rel="prefetch" href="/blog/assets/js/394.45f5f3ac.js"><link rel="prefetch" href="/blog/assets/js/395.d2bc26cb.js"><link rel="prefetch" href="/blog/assets/js/396.9b919efe.js"><link rel="prefetch" href="/blog/assets/js/397.63ae1728.js"><link rel="prefetch" href="/blog/assets/js/398.2e8cd381.js"><link rel="prefetch" href="/blog/assets/js/399.cce2bc74.js"><link rel="prefetch" href="/blog/assets/js/4.0a112c8e.js"><link rel="prefetch" href="/blog/assets/js/40.f03ea582.js"><link rel="prefetch" href="/blog/assets/js/400.bb8c8f36.js"><link rel="prefetch" href="/blog/assets/js/401.f6c8e368.js"><link rel="prefetch" href="/blog/assets/js/402.a707dd0b.js"><link rel="prefetch" href="/blog/assets/js/403.0246ef9d.js"><link rel="prefetch" href="/blog/assets/js/404.4e8fab18.js"><link rel="prefetch" href="/blog/assets/js/405.aac86c74.js"><link rel="prefetch" href="/blog/assets/js/406.ec295aee.js"><link rel="prefetch" href="/blog/assets/js/407.0c9bfe75.js"><link rel="prefetch" href="/blog/assets/js/408.90280ec4.js"><link rel="prefetch" href="/blog/assets/js/409.17f43c16.js"><link rel="prefetch" href="/blog/assets/js/41.14a66d79.js"><link rel="prefetch" href="/blog/assets/js/410.a8bcf7af.js"><link rel="prefetch" href="/blog/assets/js/411.1c299cf8.js"><link rel="prefetch" href="/blog/assets/js/412.993fde1e.js"><link rel="prefetch" href="/blog/assets/js/413.24086a2e.js"><link rel="prefetch" href="/blog/assets/js/414.669b21b7.js"><link rel="prefetch" href="/blog/assets/js/415.c6e0b851.js"><link rel="prefetch" href="/blog/assets/js/416.2c0b5a27.js"><link rel="prefetch" href="/blog/assets/js/417.035fbe19.js"><link rel="prefetch" href="/blog/assets/js/418.e9ba8e2d.js"><link rel="prefetch" href="/blog/assets/js/419.40436cbb.js"><link rel="prefetch" href="/blog/assets/js/42.7ca1a3b9.js"><link rel="prefetch" href="/blog/assets/js/420.a44f38b1.js"><link rel="prefetch" href="/blog/assets/js/421.d483449e.js"><link rel="prefetch" href="/blog/assets/js/422.85f0223d.js"><link rel="prefetch" href="/blog/assets/js/423.73b2df81.js"><link rel="prefetch" href="/blog/assets/js/424.c171262a.js"><link rel="prefetch" href="/blog/assets/js/425.84861e5f.js"><link rel="prefetch" href="/blog/assets/js/427.4f055173.js"><link rel="prefetch" href="/blog/assets/js/428.f1a79a71.js"><link rel="prefetch" href="/blog/assets/js/429.0b1e1ae8.js"><link rel="prefetch" href="/blog/assets/js/43.7f730e4f.js"><link rel="prefetch" href="/blog/assets/js/430.98b90971.js"><link rel="prefetch" href="/blog/assets/js/431.ccab63f7.js"><link rel="prefetch" href="/blog/assets/js/432.b36287bb.js"><link rel="prefetch" href="/blog/assets/js/433.b629a88d.js"><link rel="prefetch" href="/blog/assets/js/434.94c5b829.js"><link rel="prefetch" href="/blog/assets/js/435.2f5ebc90.js"><link rel="prefetch" href="/blog/assets/js/436.af40a468.js"><link rel="prefetch" href="/blog/assets/js/437.1ac4edac.js"><link rel="prefetch" href="/blog/assets/js/438.4b5c3858.js"><link rel="prefetch" href="/blog/assets/js/439.b201f9e1.js"><link rel="prefetch" href="/blog/assets/js/44.6a0d0a24.js"><link rel="prefetch" href="/blog/assets/js/440.90bbfc9c.js"><link rel="prefetch" href="/blog/assets/js/441.edaf49dd.js"><link rel="prefetch" href="/blog/assets/js/442.46358509.js"><link rel="prefetch" href="/blog/assets/js/443.ac894823.js"><link rel="prefetch" href="/blog/assets/js/444.388b0fb5.js"><link rel="prefetch" href="/blog/assets/js/445.5d6dcd5a.js"><link rel="prefetch" href="/blog/assets/js/446.cd463a00.js"><link rel="prefetch" href="/blog/assets/js/447.fa3cf170.js"><link rel="prefetch" href="/blog/assets/js/448.d166f1a6.js"><link rel="prefetch" href="/blog/assets/js/449.9007f738.js"><link rel="prefetch" href="/blog/assets/js/45.ce2504cf.js"><link rel="prefetch" href="/blog/assets/js/450.0e3c2b8d.js"><link rel="prefetch" href="/blog/assets/js/451.77ec44a8.js"><link rel="prefetch" href="/blog/assets/js/452.65334147.js"><link rel="prefetch" href="/blog/assets/js/453.bd40db54.js"><link rel="prefetch" href="/blog/assets/js/454.c680bf9b.js"><link rel="prefetch" href="/blog/assets/js/455.d3ba9987.js"><link rel="prefetch" href="/blog/assets/js/456.ba670ab8.js"><link rel="prefetch" href="/blog/assets/js/457.a56c9694.js"><link rel="prefetch" href="/blog/assets/js/458.8c7575e6.js"><link rel="prefetch" href="/blog/assets/js/459.4f64a00d.js"><link rel="prefetch" href="/blog/assets/js/46.df740708.js"><link rel="prefetch" href="/blog/assets/js/460.12329cff.js"><link rel="prefetch" href="/blog/assets/js/461.eaac64b6.js"><link rel="prefetch" href="/blog/assets/js/462.e8791604.js"><link rel="prefetch" href="/blog/assets/js/463.b7a30366.js"><link rel="prefetch" href="/blog/assets/js/464.9405a358.js"><link rel="prefetch" href="/blog/assets/js/465.a2dc9a55.js"><link rel="prefetch" href="/blog/assets/js/466.069ca07c.js"><link rel="prefetch" href="/blog/assets/js/467.60978d4b.js"><link rel="prefetch" href="/blog/assets/js/468.3ff4f7cd.js"><link rel="prefetch" href="/blog/assets/js/469.35f3e9f1.js"><link rel="prefetch" href="/blog/assets/js/47.63e54aab.js"><link rel="prefetch" href="/blog/assets/js/470.2ae1c32a.js"><link rel="prefetch" href="/blog/assets/js/471.5b85826b.js"><link rel="prefetch" href="/blog/assets/js/472.0542f8ee.js"><link rel="prefetch" href="/blog/assets/js/473.817388b7.js"><link rel="prefetch" href="/blog/assets/js/474.24200d13.js"><link rel="prefetch" href="/blog/assets/js/475.c8782c45.js"><link rel="prefetch" href="/blog/assets/js/476.6db72d54.js"><link rel="prefetch" href="/blog/assets/js/477.95a3d492.js"><link rel="prefetch" href="/blog/assets/js/478.9c8e6497.js"><link rel="prefetch" href="/blog/assets/js/479.35f9bf3b.js"><link rel="prefetch" href="/blog/assets/js/48.83140357.js"><link rel="prefetch" href="/blog/assets/js/480.b51a5165.js"><link rel="prefetch" href="/blog/assets/js/481.4d8e51e2.js"><link rel="prefetch" href="/blog/assets/js/482.65cedab1.js"><link rel="prefetch" href="/blog/assets/js/483.ca1776b9.js"><link rel="prefetch" href="/blog/assets/js/484.33a33eff.js"><link rel="prefetch" href="/blog/assets/js/485.e465197e.js"><link rel="prefetch" href="/blog/assets/js/486.70acef33.js"><link rel="prefetch" href="/blog/assets/js/487.ee3fc769.js"><link rel="prefetch" href="/blog/assets/js/488.a63e51e5.js"><link rel="prefetch" href="/blog/assets/js/489.0f3c49d5.js"><link rel="prefetch" href="/blog/assets/js/49.d8832e95.js"><link rel="prefetch" href="/blog/assets/js/490.5712118b.js"><link rel="prefetch" href="/blog/assets/js/491.5375baa1.js"><link rel="prefetch" href="/blog/assets/js/492.37c94ed4.js"><link rel="prefetch" href="/blog/assets/js/493.9b961f5e.js"><link rel="prefetch" href="/blog/assets/js/494.feea28ac.js"><link rel="prefetch" href="/blog/assets/js/495.98ea50ff.js"><link rel="prefetch" href="/blog/assets/js/496.33d53d3c.js"><link rel="prefetch" href="/blog/assets/js/497.9de40aa3.js"><link rel="prefetch" href="/blog/assets/js/498.4cd030db.js"><link rel="prefetch" href="/blog/assets/js/499.05109d7f.js"><link rel="prefetch" href="/blog/assets/js/5.c0f04726.js"><link rel="prefetch" href="/blog/assets/js/50.2c216e5d.js"><link rel="prefetch" href="/blog/assets/js/500.7b8f1773.js"><link rel="prefetch" href="/blog/assets/js/501.dfbba9a8.js"><link rel="prefetch" href="/blog/assets/js/502.90f5bd1b.js"><link rel="prefetch" href="/blog/assets/js/503.9cefed56.js"><link rel="prefetch" href="/blog/assets/js/504.789de515.js"><link rel="prefetch" href="/blog/assets/js/505.e3eb2619.js"><link rel="prefetch" href="/blog/assets/js/506.26a895a8.js"><link rel="prefetch" href="/blog/assets/js/507.aece8a26.js"><link rel="prefetch" href="/blog/assets/js/508.82ef6fd3.js"><link rel="prefetch" href="/blog/assets/js/509.6617c24f.js"><link rel="prefetch" href="/blog/assets/js/51.9924df0f.js"><link rel="prefetch" href="/blog/assets/js/510.5251c4fc.js"><link rel="prefetch" href="/blog/assets/js/511.15d303a7.js"><link rel="prefetch" href="/blog/assets/js/512.ec4dbe26.js"><link rel="prefetch" href="/blog/assets/js/513.fee5a2b7.js"><link rel="prefetch" href="/blog/assets/js/514.3f48b9d4.js"><link rel="prefetch" href="/blog/assets/js/515.8e750dd4.js"><link rel="prefetch" href="/blog/assets/js/516.bc7ce9ec.js"><link rel="prefetch" href="/blog/assets/js/517.5c273689.js"><link rel="prefetch" href="/blog/assets/js/518.8204db0b.js"><link rel="prefetch" href="/blog/assets/js/519.4069fac5.js"><link rel="prefetch" href="/blog/assets/js/52.c6b270fd.js"><link rel="prefetch" href="/blog/assets/js/520.6052378c.js"><link rel="prefetch" href="/blog/assets/js/521.a84e2f70.js"><link rel="prefetch" href="/blog/assets/js/522.07f1fd3a.js"><link rel="prefetch" href="/blog/assets/js/523.81cd7c5a.js"><link rel="prefetch" href="/blog/assets/js/524.0c27a30c.js"><link rel="prefetch" href="/blog/assets/js/525.3d388127.js"><link rel="prefetch" href="/blog/assets/js/526.da896981.js"><link rel="prefetch" href="/blog/assets/js/53.37b57eac.js"><link rel="prefetch" href="/blog/assets/js/54.07db747b.js"><link rel="prefetch" href="/blog/assets/js/55.74ef4683.js"><link rel="prefetch" href="/blog/assets/js/56.2fef63ab.js"><link rel="prefetch" href="/blog/assets/js/57.ed0c5fb3.js"><link rel="prefetch" href="/blog/assets/js/58.ca7cbf9a.js"><link rel="prefetch" href="/blog/assets/js/59.3c22bc5a.js"><link rel="prefetch" href="/blog/assets/js/6.2297b244.js"><link rel="prefetch" href="/blog/assets/js/60.262e5867.js"><link rel="prefetch" href="/blog/assets/js/61.5636e75a.js"><link rel="prefetch" href="/blog/assets/js/62.7dd1d109.js"><link rel="prefetch" href="/blog/assets/js/63.d0773cdd.js"><link rel="prefetch" href="/blog/assets/js/64.997275ff.js"><link rel="prefetch" href="/blog/assets/js/65.07901344.js"><link rel="prefetch" href="/blog/assets/js/66.c464da45.js"><link rel="prefetch" href="/blog/assets/js/67.feffb1d6.js"><link rel="prefetch" href="/blog/assets/js/68.fcfe1349.js"><link rel="prefetch" href="/blog/assets/js/69.e895924e.js"><link rel="prefetch" href="/blog/assets/js/7.e4af8b84.js"><link rel="prefetch" href="/blog/assets/js/70.078c407f.js"><link rel="prefetch" href="/blog/assets/js/71.557206d7.js"><link rel="prefetch" href="/blog/assets/js/72.e1584320.js"><link rel="prefetch" href="/blog/assets/js/73.48a20011.js"><link rel="prefetch" href="/blog/assets/js/74.20421f04.js"><link rel="prefetch" href="/blog/assets/js/75.3b0e05dc.js"><link rel="prefetch" href="/blog/assets/js/76.2bf10aca.js"><link rel="prefetch" href="/blog/assets/js/77.02348743.js"><link rel="prefetch" href="/blog/assets/js/78.cfbc295c.js"><link rel="prefetch" href="/blog/assets/js/79.453eacb3.js"><link rel="prefetch" href="/blog/assets/js/8.d80735f1.js"><link rel="prefetch" href="/blog/assets/js/80.2b500eb9.js"><link rel="prefetch" href="/blog/assets/js/81.387b7278.js"><link rel="prefetch" href="/blog/assets/js/82.1aa40d78.js"><link rel="prefetch" href="/blog/assets/js/83.17f6510a.js"><link rel="prefetch" href="/blog/assets/js/84.db4405bb.js"><link rel="prefetch" href="/blog/assets/js/85.145ce263.js"><link rel="prefetch" href="/blog/assets/js/86.139ef9a8.js"><link rel="prefetch" href="/blog/assets/js/87.824e85b1.js"><link rel="prefetch" href="/blog/assets/js/88.bd8c36c2.js"><link rel="prefetch" href="/blog/assets/js/89.ff5dab67.js"><link rel="prefetch" href="/blog/assets/js/9.c2a5941b.js"><link rel="prefetch" href="/blog/assets/js/90.750d7f60.js"><link rel="prefetch" href="/blog/assets/js/91.f93ed10a.js"><link rel="prefetch" href="/blog/assets/js/92.a9ecf2e9.js"><link rel="prefetch" href="/blog/assets/js/93.ac344da4.js"><link rel="prefetch" href="/blog/assets/js/94.57871314.js"><link rel="prefetch" href="/blog/assets/js/95.32361ad9.js"><link rel="prefetch" href="/blog/assets/js/96.fa531423.js"><link rel="prefetch" href="/blog/assets/js/97.f3eaaba1.js"><link rel="prefetch" href="/blog/assets/js/98.a6622376.js"><link rel="prefetch" href="/blog/assets/js/99.d04a5a4b.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.b6bbc000.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/images/learn.png" alt="zouyu-Blog" class="logo"> <span class="site-name can-hide">zouyu-Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记文章" class="dropdown-title"><span class="title">笔记文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记文章" class="mobile-dropdown-title"><span class="title">笔记文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/SpringCloud/" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-item"><!----> <a href="/blog/Deploy/Jenkins/Jenkins/" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/blog/Deploy/" class="nav-link">
  Deploy
</a></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="邹宇的Blog" class="dropdown-title"><span class="title">邹宇的Blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="邹宇的Blog" class="mobile-dropdown-title"><span class="title">邹宇的Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/mqyqingfeng/Blog/issues/235" target="_blank" rel="noopener noreferrer" class="nav-link external">
  搭建
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zouyu0310.github.io/chatGPT_html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  chatGPT
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="官方文档学习" class="dropdown-title"><span class="title">官方文档学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="官方文档学习" class="mobile-dropdown-title"><span class="title">官方文档学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.vuepress.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  跳转
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="笔记文章" class="dropdown-title"><span class="title">笔记文章</span> <span class="arrow down"></span></button> <button type="button" aria-label="笔记文章" class="mobile-dropdown-title"><span class="title">笔记文章</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/SpringCloud/" class="nav-link">
  SpringCloud
</a></li><li class="dropdown-item"><!----> <a href="/blog/Deploy/Jenkins/Jenkins/" class="nav-link">
  Jenkins
</a></li><li class="dropdown-item"><!----> <a href="/blog/Deploy/" class="nav-link">
  Deploy
</a></li></ul></div></div><div class="nav-item"><a href="/blog/about/" class="nav-link">
  关于
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="邹宇的Blog" class="dropdown-title"><span class="title">邹宇的Blog</span> <span class="arrow down"></span></button> <button type="button" aria-label="邹宇的Blog" class="mobile-dropdown-title"><span class="title">邹宇的Blog</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/mqyqingfeng/Blog/issues/235" target="_blank" rel="noopener noreferrer" class="nav-link external">
  搭建
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="https://zouyu0310.github.io/chatGPT_html/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  chatGPT
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="官方文档学习" class="dropdown-title"><span class="title">官方文档学习</span> <span class="arrow down"></span></button> <button type="button" aria-label="官方文档学习" class="mobile-dropdown-title"><span class="title">官方文档学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.vuepress.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  跳转
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>About</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Business</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Database</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deploy</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Interview</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>MQ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Other</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Server</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Spring Boot</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Note</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>尚硅谷 Spring Boot</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot入门简介.html" class="sidebar-link">一、Spring Boot入门</a></li><li><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot尚硅谷笔记.html" class="sidebar-link">一、Spring Boot 入门</a></li><li><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html" class="active sidebar-link">SpringBoot的高级教程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#一、springboot缓存" class="sidebar-link">一、SpringBoot缓存</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_1、jsr107缓存规范" class="sidebar-link">1、JSR107缓存规范</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_2、spring的缓存抽象" class="sidebar-link">2、Spring的缓存抽象</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_1、基本概念" class="sidebar-link">1、基本概念</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_2、整合项目" class="sidebar-link">2、整合项目</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_3、缓存原理" class="sidebar-link">3、缓存原理</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_4、cache的注解" class="sidebar-link">4、Cache的注解</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_5、redis" class="sidebar-link">5、Redis</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#二、springboot的消息中间件" class="sidebar-link">二、SpringBoot的消息中间件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_1、jms-amqp简介" class="sidebar-link">1、JMS&amp;AMQP简介</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_2、rabbitmq简介" class="sidebar-link">2、RabbitMQ简介</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#三、springboot的检索" class="sidebar-link">三、SpringBoot的检索</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_1、elasticsearch简介" class="sidebar-link">1、ElasticSearch简介</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_2、elasticsearch的安装" class="sidebar-link">2、ElasticSearch的安装</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_3、elastic的快速入门" class="sidebar-link">3、Elastic的快速入门</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_4、springboot-elasticsearch" class="sidebar-link">4、SpringBoot+ElasticSearch</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#四、springboot的任务" class="sidebar-link">四、SpringBoot的任务</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#五、springboot的安全" class="sidebar-link">五、SpringBoot的安全</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#六、springboot的分布式" class="sidebar-link">六、SpringBoot的分布式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_1、dubbo简介" class="sidebar-link">1、Dubbo简介</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_2、zookeeper" class="sidebar-link">2、Zookeeper</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_3、dubbo、zookeeper整合" class="sidebar-link">3、Dubbo、Zookeeper整合</a></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#_4、springcloud" class="sidebar-link">4、SpringCloud</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot高级教程.html#七、springboot的监管" class="sidebar-link">七、SpringBoot的监管</a></li></ul></li></ul></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Cloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Tools</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Web</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Work Doc</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>尚硅谷 Redis</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="springboot的高级教程"><a href="#springboot的高级教程" class="header-anchor">#</a> SpringBoot的高级教程</h1> <h2 id="一、springboot缓存"><a href="#一、springboot缓存" class="header-anchor">#</a> 一、SpringBoot缓存</h2> <p>缓存的场景</p> <ul><li>临时性数据存储【校验码】</li> <li>避免频繁因为相同的内容查询数据库【查询的信息】</li></ul> <h2 id="_1、jsr107缓存规范"><a href="#_1、jsr107缓存规范" class="header-anchor">#</a> 1、JSR107缓存规范</h2> <blockquote><p>用的比较少</p></blockquote> <p>Java Caching定义了5个核心接口</p> <ul><li><p>CachingProvider</p> <p>定义了创建、配置、获取、管理和控制多个CacheManager。一个应用可以在运行期间访问多个CachingProvider</p></li> <li><p>CacheManager</p> <p>定义了创建、配置、获取、管理和控制多个唯一命名的Cache,这些Cache存在于CacheManage的上下文中，一个CacheManage只被一个CachingProvider拥有</p></li> <li><p>Cache</p> <p>类似于Map的数据结构并临时储存以key为索引的值，一个Cache仅仅被一个CacheManage所拥有</p></li> <li><p>Entry</p> <p>存储在Cache中的key-value对</p></li> <li><p>Expiry</p> <p>存储在Cache的条目有一个定义的有效期，一旦超过这个时间，就会设置过期的状态，过期无法被访问，更新，删除。缓存的有效期可以通过ExpiryPolicy设置。</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C35.cache.png" alt="35.cache"></p></li></ul> <h2 id="_2、spring的缓存抽象"><a href="#_2、spring的缓存抽象" class="header-anchor">#</a> 2、Spring的缓存抽象</h2> <p>包括一些JSR107的注解</p> <p>CahceManager</p> <p>Cache</p> <h3 id="_1、基本概念"><a href="#_1、基本概念" class="header-anchor">#</a> 1、基本概念</h3> <p><strong>重要的概念&amp;缓存注解</strong></p> <table><thead><tr><th></th> <th style="text-align:left;">功能</th></tr></thead> <tbody><tr><td>Cache</td> <td style="text-align:left;">缓存接口，定义缓存操作，实现有：RedisCache、EhCacheCache、ConcurrentMapCache等</td></tr> <tr><td>CacheManager</td> <td style="text-align:left;">缓存管理器，管理各种缓存（Cache）组件</td></tr> <tr><td>@Cacheable</td> <td style="text-align:left;">针对方法配置，根据方法的请求参数对其结果进行缓存</td></tr> <tr><td>@CacheEvict</td> <td style="text-align:left;">清空缓存</td></tr> <tr><td>@CachePut</td> <td style="text-align:left;">保证方法被调用，又希望结果被缓存 update，调用，将信息更新缓存</td></tr> <tr><td>@EnableCaching</td> <td style="text-align:left;">开启基于注解的缓存</td></tr> <tr><td>KeyGenerator</td> <td style="text-align:left;">缓存数据时key生成的策略</td></tr> <tr><td>serialize</td> <td style="text-align:left;">缓存数据时value序列化策略</td></tr></tbody></table> <h3 id="_2、整合项目"><a href="#_2、整合项目" class="header-anchor">#</a> 2、整合项目</h3> <p>1、新建一个SpringBoot1.5+web+mysql+mybatis+cache</p> <p>2、编写配置文件，连接Mysql</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token key attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.jdbc.Driver</span>
<span class="token key attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://192.168.179.131:3306/mybatis01</span>
<span class="token key attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token key attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token value attr-value">Welcome_1</span>
<span class="token key attr-name">mybatis.configuration.map-underscore-to-camel-case</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">9000</span>
</code></pre></div><p>3、创建一个bean实例</p> <p>Department</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> deptName<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> deptName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deptName <span class="token operator">=</span> deptName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDeptName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> deptName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDeptName</span><span class="token punctuation">(</span><span class="token class-name">String</span> deptName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>deptName <span class="token operator">=</span> deptName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Department{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;id=&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span>
                <span class="token string">&quot;, deptName='&quot;</span> <span class="token operator">+</span> deptName <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Employee</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> gender<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> dId<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLastName</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> lastName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getGender</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> gender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setGender</span><span class="token punctuation">(</span><span class="token class-name">String</span> gender<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>gender <span class="token operator">=</span> gender<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> email<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setEmail</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>email <span class="token operator">=</span> email<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getdId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setdId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> dId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dId <span class="token operator">=</span> dId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Employee{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;id=&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span>
                <span class="token string">&quot;, lastName='&quot;</span> <span class="token operator">+</span> lastName <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, gender='&quot;</span> <span class="token operator">+</span> gender <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, email='&quot;</span> <span class="token operator">+</span> email <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, dId=&quot;</span> <span class="token operator">+</span> dId <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4、创建mapper接口映射数据库，并访问数据库中的数据</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>mapper</span><span class="token punctuation">;</span>


<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Employee</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Mapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Select</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>ibatis<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">Update</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">EmployeeMapper</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">&quot;SELECT * FROM employee WHERE id = #{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmpById</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">&quot;UPDATE employee SET lastName=#{lastName},email=#{email},gender=#{gender},d_id=#{dId} WHERE id=#{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>5、主程序添加注解MapperScan，并且使用@EnableCaching开启缓存</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">MapperScan</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableCaching</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@EnableCaching</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span><span class="token string">&quot;com.wdjr.cache.mapper&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Springboot01CacheApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Springboot01CacheApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>6、编写service，来具体实现mapper中的方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>bean<span class="token punctuation">.</span></span><span class="token class-name">Employee</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">EmployeeMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Cacheable</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">EmployeeMapper</span> employeeMapper<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 将方法的运行结果进行缓存，以后要是再有相同的数据，直接从缓存中获取，不用调用方法
     * CacheManager中管理多个Cache组件，对缓存的真正CRUD操作在Cache组件中，每个缓存组件都有自己的唯一名字；
     *
     * 属性：
     *  CacheName/value:指定存储缓存组件的名字
     *  key:缓存数据使用的key,可以使用它来指定。默认是使用方法参数的值，1-方法的返回值
     *  编写Spel表达式：#id 参数id的值， #a0/#p0 #root.args[0]
     *  keyGenerator:key的生成器，自己可以指定key的生成器的组件id
     *  key/keyGendertor二选一使用
     *
     *  cacheManager指定Cache管理器，或者cacheReslover指定获取解析器
     *  condition:指定符合条件的情况下，才缓存；
     *  unless：否定缓存，unless指定的条件为true，方法的返回值就不会被缓存，可以获取到结果进行判断
     *  sync:是否使用异步模式，unless不支持
     *
     *
     * @param id
     * @return
     */</span>
    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#id&quot;</span><span class="token punctuation">,</span>condition <span class="token operator">=</span> <span class="token string">&quot;#id&gt;0&quot;</span><span class="token punctuation">,</span>unless <span class="token operator">=</span> <span class="token string">&quot;#result==null&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;查询id= &quot;</span><span class="token operator">+</span>id<span class="token operator">+</span><span class="token string">&quot;的员工&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>7、编写controller测试</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">EmployeeService</span> employeeService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/emp/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmp</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> employeeService<span class="token punctuation">.</span><span class="token function">getEmp</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>8、测试结果</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C35.cache.jpg" alt="35.cache"></p> <p>继续访问，就不会执行方法，因为直接在缓存中取值</p> <h3 id="_3、缓存原理"><a href="#_3、缓存原理" class="header-anchor">#</a> 3、缓存原理</h3> <p>原理：</p> <p>1、CacheAutoConfiguration</p> <p>2、导入缓存组件</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C36.importcache.jpg" alt="36.importcache"></p> <p>3、查看哪个缓存配置生效</p> <div class="language- extra-class"><pre class="language-text"><code>SimpleCacheConfiguration生效
</code></pre></div><p>4、给容器注册一个CacheManager:ConcurrentMapCacheManager</p> <p>5、可以获取和创建ConcurrentMapCache,作用是将数据保存在ConcurrentMap中</p> <p>运行流程</p> <p>1、方法运行之前，先查Cache(缓存组件），按照cacheName的指定名字获取；</p> <p>（CacheManager先获取相应的缓存），第一次获取缓存如果没有cache组件会自己创建</p> <p>2、去Cache中查找缓存的内容，使用一个key，默认就是方法的参数；</p> <p>key是按照某种策略生成的，默认是使用keyGenerator生成的，默认使用SimpleKeyGenerator生成key</p> <p>没有参数 key=new SimpleKey()</p> <p>如果有一个参数 key=参数值</p> <p>如果多个参数 key=new SimpleKey(params);</p> <p>3、没有查到缓存就调用目标方法</p> <p>4、将目标方法返回的结果，放回缓存中</p> <p>方法执行之前，@Cacheable先来检查缓存中是否有数据，按照参数的值作为key去查询缓存，如果没有，就运行方法，存入缓存，如果有数据，就取出map的值。</p> <h3 id="_4、cache的注解"><a href="#_4、cache的注解" class="header-anchor">#</a> 4、Cache的注解</h3> <h4 id="_1、-cacheput"><a href="#_1、-cacheput" class="header-anchor">#</a> 1、@Cacheput</h4> <p>修改数据库的某个数据，同时更新缓存</p> <p>运行时机</p> <p>先运行方法，再将目标结果缓存起来</p> <blockquote><p>cacheable的key是不能使用result的参数的</p></blockquote> <p>1、编写更新方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">&quot;emp&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#result.id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">updateEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;updateEmp&quot;</span><span class="token operator">+</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    employeeMapper<span class="token punctuation">.</span><span class="token function">updateEmp</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> employee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2、编写Controller方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/emp&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">updateEmp</span><span class="token punctuation">(</span><span class="token class-name">Employee</span> employee<span class="token punctuation">)</span><span class="token punctuation">{</span>
    employeeService<span class="token punctuation">.</span><span class="token function">updateEmp</span><span class="token punctuation">(</span>employee<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> employee<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>测试</p> <p>测试步骤</p> <p>1、先查询1号员工</p> <p>2、更新1号员工数据</p> <p>3、查询1号员工</p> <p>可能并没有更新，</p> <p>是因为查询和更新的key不同</p> <p>效果：</p> <ul><li>第一次查询：查询mysql</li> <li>第二次更新：更新mysql</li> <li>第三次查询：调用内存</li></ul> <h4 id="_2、cacheevict"><a href="#_2、cacheevict" class="header-anchor">#</a> 2、CacheEvict</h4> <p>清除缓存</p> <p>编写测试方法</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span>  <span class="token keyword">void</span>  <span class="token function">deleteEmp</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;delete的id&quot;</span><span class="token operator">+</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>allEntries = true,代表不论清除那个key，都重新刷新缓存</p> <p>beforeInvocation=true.方法执行前，清空缓存，默认是false,如果程序异常，就不会清除缓存</p> <h4 id="_3、caching"><a href="#_3、caching" class="header-anchor">#</a> 3、Caching</h4> <p>组合</p> <ul><li>Cacheable</li> <li>CachePut</li> <li>CacheEvict</li></ul> <p>CacheConfig抽取缓存的公共配置</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@CacheConfig</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EmployeeService</span> <span class="token punctuation">{</span>
</code></pre></div><p>然后下面的value=emp就不用写了</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Caching</span><span class="token punctuation">(</span>
        cacheable <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#lastName&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        put <span class="token operator">=</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#result.id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;emp&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;#result.gender&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">Employee</span> <span class="token function">getEmpByLastName</span><span class="token punctuation">(</span><span class="token class-name">String</span> lastName<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpByLastName</span><span class="token punctuation">(</span>lastName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果查完lastName,再查的id是刚才的值，就会直接从缓存中获取数据</p> <h3 id="_5、redis"><a href="#_5、redis" class="header-anchor">#</a> 5、Redis</h3> <p>默认的缓存是在内存中定义HashMap，生产中使用Redis的缓存中间件</p> <p>Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件</p> <h4 id="_1、安装docker"><a href="#_1、安装docker" class="header-anchor">#</a> 1、安装Docker</h4> <p>安装redis在docker上</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#拉取redis镜像</span>
<span class="token function">docker</span> pull redis
<span class="token comment">#启动redis[bfcb1f6df2db]docker images的id</span>
 <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">6379</span>:6379 <span class="token parameter variable">--name</span> redis01 bfcb1f6df2db
</code></pre></div><h4 id="_2、redis的template"><a href="#_2、redis的template" class="header-anchor">#</a> 2、Redis的Template</h4> <p>Redis的常用五大数据类型</p> <p>String【字符串】、List【列表】、Set【集合】、Hash【散列】、ZSet【有序集合】</p> <p>分为两种一种是<strong>StringRedisTemplate</strong>，另一种是<strong>RedisTemplate</strong></p> <p>根据不同的数据类型，大致的操作也分为这5种，以StringRedisTemplate为例</p> <div class="language- extra-class"><pre class="language-text"><code>stringRedisTemplate.opsForValue()  --String
stringRedisTemplate.opsForList()  --List
stringRedisTemplate.opsForSet()  --Set
stringRedisTemplate.opsForHash()  --Hash
stringRedisTemplate.opsForZset()  -Zset
</code></pre></div><p>1、导入依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>2、修改配置文件</p> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token key attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token value attr-value">192.168.179.131</span>
</code></pre></div><p>3、添加测试类</p> <div class="language-java extra-class"><pre class="language-java"><code>    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span><span class="token comment">//操作字符串【常用】</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span><span class="token comment">//操作k-v都是对象    </span>
	<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token comment">//        stringRedisTemplate.opsForValue().append(&quot;msg&quot;, &quot;hello&quot;);</span>
        <span class="token class-name">String</span> msg <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>写入数据</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C37.redis.jpg" alt="37.redis"></p> <p>读取数据</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C38.redis02.jpg" alt="38.redis02"></p> <h4 id="_3、测试保存对象"><a href="#_3、测试保存对象" class="header-anchor">#</a> 3、测试保存对象</h4> <blockquote><p>对象需要序列化</p></blockquote> <p>1、序列化bean对象</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
</code></pre></div><p>2、将对象存储到Redis</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpById</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;emp-01&quot;</span><span class="token punctuation">,</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3、效果演示</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C38.redis03.jpg" alt="38.redis03"></p> <h4 id="_4、以json方式传输对象"><a href="#_4、以json方式传输对象" class="header-anchor">#</a> 4、以json方式传输对象</h4> <p>1、新建一个Redis的配置类MyRedisConfig,</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyRedisConfig</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> <span class="token function">empRedisTemplate</span><span class="token punctuation">(</span>
            <span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> <span class="token class-name">UnknownHostException</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span> <span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> jsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Employee</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setDefaultSerializer</span><span class="token punctuation">(</span>jsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>2、编写测试类</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token annotation punctuation">@Autowired</span>
 <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">,</span><span class="token class-name">Employee</span><span class="token punctuation">&gt;</span></span> empRedisTemplate<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Employee</span> emp <span class="token operator">=</span> employeeMapper<span class="token punctuation">.</span><span class="token function">getEmpById</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    empRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;emp-01&quot;</span><span class="token punctuation">,</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>3、测试效果</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C39.redis04.jpg" alt="39.redis04"></p> <h2 id="二、springboot的消息中间件"><a href="#二、springboot的消息中间件" class="header-anchor">#</a> 二、SpringBoot的消息中间件</h2> <h3 id="_1、jms-amqp简介"><a href="#_1、jms-amqp简介" class="header-anchor">#</a> 1、JMS&amp;AMQP简介</h3> <p>1、异步处理</p> <p>同步机制</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C09.%E5%90%8C%E6%AD%A5.png" alt="09.同步"></p> <p>并发机制</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C10.%E5%BC%82%E6%AD%A5.png" alt="10.异步"></p> <p>消息队列机制</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C11.%E6%B6%88%E6%81%AF.png" alt="11.消息"></p> <p>2、应用解耦</p> <p>使用中间件，将两个服务解耦，一个写入，一个订阅</p> <p>3、流量削锋</p> <p>例如消息队列的FIFO，限定元素的长度，防止出现多次请求导致的误操作</p> <h4 id="概述"><a href="#概述" class="header-anchor">#</a> 概述</h4> <p>1、大多数应用，可以通过消息服务中间件来提升系统的异步通信、拓展解耦能力</p> <p>2、消息服务中的两个重要概念：</p> <p>消息代理（message broker）和目的地（destination）,当消息发送者发送消息以后，将由消息代理接管，消息代理保证消息传递到指定的目的地。</p> <p>3、消息队列主要的两种形式的目的地</p> <p>1）、队列（queue）：点对点消息通信【point-to-point】，取出一个没一个，一个发布，多个消费</p> <p>2）、主题（topic）:发布（publish）/订阅（subscribe）消息通信，多人【订阅者】可以同时接到消息</p> <p>4、JMS(Java Message Service) Java消息服务：</p> <ul><li>基于JVM消息规范的代理。ActiveMQ/HornetMQ是JMS的实现</li></ul> <p>5、AMQP(Advanced Message Queuing Protocol)</p> <ul><li>高级消息队列协议，也是一个消息代理的规范，兼容JMS</li> <li>RabbitMQ是AMQP的实现</li></ul> <table><thead><tr><th></th> <th>JMS</th> <th>AMQP</th></tr></thead> <tbody><tr><td>定义</td> <td>Java API</td> <td>网络线级协议</td></tr> <tr><td>跨平台</td> <td>否</td> <td>是</td></tr> <tr><td>跨语言</td> <td>否</td> <td>是</td></tr> <tr><td>Model</td> <td>(1)、Peer-2-Peer<br>(2)、Pub/Sub</td> <td>(1)、direct exchange<br>(2)、fanout exchange<br>(3)、topic change<br>(4)、headers exchange<br>(5)、system exchange<br>后四种都是pub/sub ,差别路由机制做了更详细的划分</td></tr> <tr><td>支持消息类型</td> <td>TextMessage<br>MapMessage<br>ByteMessage<br>StreamMessage<br>ObjectMessage<br>Message</td> <td>byte[]通常需要序列化</td></tr></tbody></table> <p>6、SpringBoot的支持</p> <p>spring-jms提供了对JMS的支持</p> <p>spring-rabbit提供了对AMQP的支持</p> <p>需要创建ConnectionFactory的实现来连接消息代理</p> <p>提供JmsTemplate,RabbitTemplate来发送消息</p> <p>@JmsListener(JMS).@RabbitListener(AMQP)注解在方法上的监听消息代理发布的消息</p> <p>@EnableJms,@EnableRabbit开启支持</p> <p>7、SpringBoot的自动配置</p> <ul><li>JmsAutoConfiguration</li> <li>RabbitAutoConfiguration</li></ul> <h3 id="_2、rabbitmq简介"><a href="#_2、rabbitmq简介" class="header-anchor">#</a> 2、RabbitMQ简介</h3> <blockquote><p>AMQP的实现</p></blockquote> <h4 id="_1、核心概念"><a href="#_1、核心概念" class="header-anchor">#</a> 1、核心概念</h4> <p><strong>Message</strong>:消息头和消息体组成，消息体是不透明的，而消息头上则是由一系列的可选属性组成，属性：路由键【routing-key】,优先级【priority】,指出消息可能需要持久性存储【delivery-mode】</p> <p><strong>Publisher</strong>:消息的生产者，也是一个向交换器发布消息的客户端应用程序</p> <p><strong>Exchange</strong>:交换器，用来接收生产者发送的消息并将这些消息路由给服务器中的队列</p> <p>Exchange的4中类型：direct【默认】点对点，fanout,topic和headers, 发布订阅，不同类型的Exchange转发消息的策略有所区别</p> <p><strong>Queue</strong>:消息队列，用来保存消息直到发送给消费者，它是消息的容器，也是消息的终点，一个消息可投入一个或多个队列，消息一直在队列里面，等待消费者连接到这个队列将数据取走。</p> <p><strong>Binding</strong>:绑定，队列和交换机之间的关联，多对多关系</p> <p><strong>Connection</strong>:网络连接，例如TCP连接</p> <p>Channel:信道，多路复用连接中的一条独立的双向数据流通道，信道是建立在真是的TCP链接之内的虚拟连接AMQP命令都是通过信道发送出去的。不管是发布消息，订阅队列还是接受消息，都是信道，减少TCP的开销，复用一条TCP连接。</p> <p><strong>Consumer</strong>:消息的消费者，表示一个从消息队列中取得消息的客户端的 应用程序</p> <p><strong>VirtualHost</strong>:小型的rabbitMQ,相互隔离</p> <p><strong>Broker</strong>:表示消息队列 服务实体</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C13.RabbitMQ%E7%BB%93%E6%9E%84.png" alt="13.RabbitMQ结构"></p> <h4 id="_2、rabbitmq的运行机制"><a href="#_2、rabbitmq的运行机制" class="header-anchor">#</a> 2、RabbitMQ的运行机制</h4> <p>Exchange的三种方式</p> <p>direct：根据路由键直接匹配，一对一</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C14.RabbitMQDirect.png" alt="14.RabbitMQDirect"></p> <p>fanout:不经过路由键，直接发送到每一个队列</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C14.RabbitMQfaout.png" alt="14.RabbitMQfaout"></p> <p>topic:类似模糊匹配的根据路由键，来分配绑定的队列</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C14.RabbitMQtopic.png" alt="14.RabbitMQtopic"></p> <h4 id="_3、rabbitmq安装测试"><a href="#_3、rabbitmq安装测试" class="header-anchor">#</a> 3、RabbitMQ安装测试</h4> <p>1、打开虚拟机，在docker中安装RabbitMQ</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#1.安装rabbitmq，使用镜像加速</span>
<span class="token function">docker</span> pull registry.docker-cn.com/library/rabbitmq:3-management
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY                                     TAG                 IMAGE ID            CREATED             SIZE
registry.docker-cn.com/library/rabbitmq        <span class="token number">3</span>-management        c51d1c73d028        <span class="token number">11</span> days ago         <span class="token number">149</span> MB
<span class="token comment">#2.运行rabbitmq</span>
<span class="token comment">##### 端口：5672 客户端和rabbitmq通信 15672：管理界面的web页面</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">5672</span>:5672 <span class="token parameter variable">-p</span> <span class="token number">15672</span>:15672 <span class="token parameter variable">--name</span> myrabbitmq c51d1c73d028

<span class="token comment">#3.查看运行</span>
<span class="token function">docker</span> <span class="token function">ps</span>
</code></pre></div><p>2、打开网页客户端并登陆，账号【guest】,密码【guest】，登陆</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C13.rabbitmq.jpg" alt="13.rabbitmq"></p> <p>3、添加 【direct】【faout】【topic】的绑定关系等</p> <p>1）、添加Exchange,分别添加<strong>exchange.direct</strong>、<strong>exchange.fanout</strong>、<strong>exchange.topic</strong></p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C15.exchanges.jpg" alt="15.exchanges"></p> <p>2）、添加 Queues,分别添加<strong>lxy.news、wdjr、wdjr.emps、wdjr.news</strong></p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C16.queues.jpg" alt="16.queues"></p> <p>3）、点击【exchange.direct】添加绑定规则</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C17.bind.jpg" alt="17.bind"></p> <p>4）、点击【exchange.fanout】添加绑定规则</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C18,bindfanout.jpg" alt="18,bindfanout"></p> <p>5）、点击【exchange.topic】添加绑定规则</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C19,bind_topic.jpg" alt="19,bind_topic"></p> <blockquote><p>/*: 代表匹配1个单词</p> <p>/#：代表匹配0个或者多个单词</p></blockquote> <p>4、发布信息测试</p> <p>【direct】发布命令，点击 Publish message</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C20.publish-direct.jpg" alt="20.publish-direct"></p> <p>查看队列的数量</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C21.queue-direct.jpg" alt="21.queue-direct"></p> <p>点击查看发送的信息</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C22.msg-direct.jpg" alt="22.msg-direct"></p> <p>【fanout】的发布消息</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C23.pub-fanout.jpg" alt="23.pub-fanout"></p> <p>队列信息</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C24.queue-fanout.jpg" alt="24.queue-fanout"></p> <p>随意一个数据信息例如：wdjr.emp</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C25.msg-fanout.jpg" alt="25.msg-fanout"></p> <p>【topic】发布信息测试</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C26.pub-topic.jpg" alt="26.pub-topic"></p> <p>队列的值</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C27.que-topic.jpg" alt="27.que-topic"></p> <p>信息查看</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C28.msg-topic.jpg" alt="28.msg-topic"></p> <h4 id="_4、创建工程整合"><a href="#_4、创建工程整合" class="header-anchor">#</a> 4、创建工程整合</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token number">1</span>、<span class="token class-name">RabbitAutoConfiguration</span>
<span class="token number">2</span>、自动配置了连接工厂 <span class="token class-name">ConnectionFactory</span>
<span class="token number">3</span>、<span class="token class-name">RabbitProperties</span>封装了 <span class="token class-name">RabbitMQ</span>
<span class="token number">4</span>、<span class="token class-name">RabbitTemplate</span><span class="token operator">:</span>给<span class="token class-name">RabbitMQ</span>发送和接受消息的
<span class="token number">5</span>、<span class="token class-name">AmqpAdmin</span>：<span class="token class-name">RabbitMQ</span>的系统管理功能组件
</code></pre></div><h5 id="_1、rabbittemplate"><a href="#_1、rabbittemplate" class="header-anchor">#</a> 1、RabbitTemplate</h5> <p>1、新建SpringBoot工程，SpringBoot1.5+Integeration/RabbitMQ+Web</p> <p>2、RabbitAutoConfiguration文件</p> <p>3、编写配置文件application.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">rabbitmq</span><span class="token punctuation">:</span>
    <span class="token key atrule">host</span><span class="token punctuation">:</span> 192.168.179.131
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">5672</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> guest
    <span class="token key atrule">password</span><span class="token punctuation">:</span> guest
</code></pre></div><p>4、编写测试类,将HashMap写入Queue</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RabbitTemplate</span> rabbitTemplate<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//Message需要自己构建一个；定义消息体内容和消息头</span>
        <span class="token comment">// rabbitTemplate.send(exchange, routingKey, message);</span>
        <span class="token comment">//Object 默认当成消息体，只需要传入要发送的对象，自动化序列发送给rabbitmq；</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;这是第一个信息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;helloWorld&quot;</span><span class="token punctuation">,</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//对象被默认序列以后发送出去</span>
        rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;exchange.direct&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wdjr.news&quot;</span><span class="token punctuation">,</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>5、查看网页的信息</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C29.dir-idea.jpg" alt="29.dir-idea"></p> <p>6、取出队列的值</p> <blockquote><p>取出队列中数据就没了</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">reciverAndConvert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token class-name">Object</span> o <span class="token operator">=</span> rabbitTemplate<span class="token punctuation">.</span><span class="token function">receiveAndConvert</span><span class="token punctuation">(</span><span class="token string">&quot;wdjr.news&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
</code></pre></div><p>结果</p> <div class="language- extra-class"><pre class="language-text"><code>class java.util.HashMap
{msg=这是第一个信息, data=[helloWorld, 123, true]}
</code></pre></div><p>7、使用Json方式传递，并传入对象Book</p> <p>1）、MyAMQPConfig</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAMQPConfig</span>  <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">MessageConverter</span> <span class="token function">messageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonMessageConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2）、编写Book实体类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>amqp<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span>  bookName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token class-name">String</span> bookName<span class="token punctuation">,</span> <span class="token class-name">String</span> author<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookName <span class="token operator">=</span> bookName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>author <span class="token operator">=</span> author<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBookName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bookName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookName</span><span class="token punctuation">(</span><span class="token class-name">String</span> bookName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookName <span class="token operator">=</span> bookName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> author<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAuthor</span><span class="token punctuation">(</span><span class="token class-name">String</span> author<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>author <span class="token operator">=</span> author<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Book{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;bookName='&quot;</span> <span class="token operator">+</span> bookName <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, author='&quot;</span> <span class="token operator">+</span> author <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3）、测试类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//对象被默认序列以后发送出去</span>
    rabbitTemplate<span class="token punctuation">.</span><span class="token function">convertAndSend</span><span class="token punctuation">(</span><span class="token string">&quot;exchange.direct&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;wdjr.news&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token string">&quot;百年孤独&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;季羡林&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4）、查看wdjr.news</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C30.dir-idea-json.jpg" alt="30.dir-idea-json"></p> <p>5）、取出数据</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">reciverAndConvert</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">Object</span> o <span class="token operator">=</span> rabbitTemplate<span class="token punctuation">.</span><span class="token function">receiveAndConvert</span><span class="token punctuation">(</span><span class="token string">&quot;wdjr.news&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>6）、结果演示</p> <div class="language- extra-class"><pre class="language-text"><code>class com.wdjr.amqp.bean.Book
Book{bookName='百年孤独', author='季羡林'}
</code></pre></div><h5 id="_2、开启基于注解的方式"><a href="#_2、开启基于注解的方式" class="header-anchor">#</a> 2、开启基于注解的方式</h5> <p>1、新建一个BookService</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BookService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;wdjr.news&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive</span><span class="token punctuation">(</span><span class="token class-name">Book</span> book<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@RabbitListener</span><span class="token punctuation">(</span>queues <span class="token operator">=</span> <span class="token string">&quot;wdjr&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">receive02</span><span class="token punctuation">(</span><span class="token class-name">Message</span> message<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>message<span class="token punctuation">.</span><span class="token function">getMessageProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2、主程序开启RabbitMQ的注解</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EnableRabbit</span> <span class="token comment">//开启基于注解的rabbitmq</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AmqpApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">AmqpApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="_3、amqpadmin"><a href="#_3、amqpadmin" class="header-anchor">#</a> 3、AmqpAdmin</h5> <blockquote><p>创建和删除 Exchange 、Queue、Bind</p></blockquote> <p>1）、创建Exchange</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    amqpAdmin<span class="token punctuation">.</span><span class="token function">declareExchange</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DirectExchange</span><span class="token punctuation">(</span><span class="token string">&quot;amqpadmin.direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Create Finish&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>效果演示</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C31.createAMQP.jpg" alt="31.createAMQP"></p> <p>2）、创建Queue</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createQueue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    amqpAdmin<span class="token punctuation">.</span><span class="token function">declareQueue</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Queue</span><span class="token punctuation">(</span><span class="token string">&quot;amqpadmin.queue&quot;</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Create Queue Finish&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C32.createQueue.jpg" alt="32.createQueue"></p> <p>3）、创建Bind规则</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createBind</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    amqpAdmin<span class="token punctuation">.</span><span class="token function">declareBinding</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Binding</span><span class="token punctuation">(</span><span class="token string">&quot;amqpadmin.queue&quot;</span><span class="token punctuation">,</span><span class="token class-name">Binding<span class="token punctuation">.</span>DestinationType</span><span class="token punctuation">.</span><span class="token constant">QUEUE</span> <span class="token punctuation">,</span> <span class="token string">&quot;amqpadmin.direct&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;amqp.haha&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C33.createBinding.jpg" alt="33.createBinding"></p> <p>删除类似</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteExchange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    amqpAdmin<span class="token punctuation">.</span><span class="token function">deleteExchange</span><span class="token punctuation">(</span><span class="token string">&quot;amqpadmin.direct&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;delete Finish&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="三、springboot的检索"><a href="#三、springboot的检索" class="header-anchor">#</a> 三、SpringBoot的检索</h2> <h3 id="_1、elasticsearch简介"><a href="#_1、elasticsearch简介" class="header-anchor">#</a> 1、ElasticSearch简介</h3> <p>​          ElasticSearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前流行的企业级搜索引擎。设计用于<a href="https://baike.baidu.com/item/%E4%BA%91%E8%AE%A1%E7%AE%97" target="_blank" rel="noopener noreferrer">云计算<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中，能够达到实时搜索，稳定，可靠，快速，安装使用方便。</p> <h3 id="_2、elasticsearch的安装"><a href="#_2、elasticsearch的安装" class="header-anchor">#</a> 2、ElasticSearch的安装</h3> <p>1、安装java最新版本</p> <ul><li>下载linux的.tar.gz</li> <li>解压到指定目录</li> <li>配置环境变量</li></ul> <p>2、安装Docker(非必须这是是在Docker中安装)</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token number">1</span>、查看centos版本
<span class="token comment"># uname -r</span>
<span class="token number">3.10</span>.0-693.el7.x86_64
要求：大于3.10
如果小于的话升级*（选做）
<span class="token comment"># yum update</span>
<span class="token number">2</span>、安装docker
<span class="token comment"># yum install docker</span>
<span class="token number">3</span>、启动docker
<span class="token comment"># systemctl start docker</span>
<span class="token comment"># docker -v</span>
<span class="token number">4</span>、开机启动docker
<span class="token comment"># systemctl enable docker</span>
<span class="token number">5</span>、停止docker
<span class="token comment"># systemctl stop docker</span>
</code></pre></div><p>3、安装ElasticSearch的镜像</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> pull registry.docker-cn.com/library/elasticsearch
</code></pre></div><p>4、运行ElasticSearch</p> <blockquote><p>-e ES_JAVA_OPTS=&quot;-Xms256m -Xmx256m&quot; 表示占用的最大内存为256m,默认是2G</p></blockquote> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY                                     TAG                 IMAGE ID                                                                   CREATED             SIZE
registry.docker-cn.com/library/elasticsearch   latest              671bb2d7da44                                                               <span class="token number">32</span> hours ago        <span class="token number">486</span> MB
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment">#</span>
<span class="token punctuation">[</span>root@node1 ~<span class="token punctuation">]</span><span class="token comment"># docker run -e ES_JAVA_OPTS=&quot;-Xms256m -Xmx256m&quot; -d -p 9200:9200 -p 9300:9300 --name ES01 671bb2d7da44</span>
</code></pre></div><p>5、测试是否启动成功</p> <p>访问9200端口：http://192.168.179.131:9200/  查看是否返回json数据</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;onB-EUU&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cluster_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;elasticsearch&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cluster_uuid&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;j3SXX6tdThWUomW3tAvDFg&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;version&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;number&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;5.6.9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_hash&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;877a590&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_date&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;2018-04-12T16:25:14.838Z&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build_snapshot&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lucene_version&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;6.6.1&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tagline&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;You Know, for Search&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3、elastic的快速入门"><a href="#_3、elastic的快速入门" class="header-anchor">#</a> 3、Elastic的快速入门</h3> <blockquote><p>最好的工具就是<a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/getting-started.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，以下操作都在文档中进行操作。</p></blockquote> <h4 id="_1、基础概念"><a href="#_1、基础概念" class="header-anchor">#</a> 1、基础概念</h4> <p>面向文档，JSON作为序列化格式，ElasticSearch的基本概念</p> <p><strong>索引（名词）：</strong></p> <p>如前所述，一个 <em>索引</em> 类似于传统关系数据库中的一个 <em>数据库</em> ，是一个存储关系型文档的地方。 <em>索引</em> (<em>index</em>) 的复数词为 <em>indices</em> 或 <em>indexes</em> 。</p> <p><strong>索引（动词）：</strong></p> <p><em>索引一个文档</em> 就是存储一个文档到一个 <em>索引</em> （名词）中以便它可以被检索和查询到。这非常类似于 SQL 语句中的 <code>INSERT</code> 关键词，除了文档已存在时新文档会替换旧文档情况之外。</p> <p><strong>类型</strong>：相当于数据库中的表</p> <p><strong>文档</strong>：相当于数据库中的行，即每条数据都叫一个文档</p> <p><strong>属性</strong>：相当于数据库中的列，即文档的属性</p> <h4 id="_2、测试"><a href="#_2、测试" class="header-anchor">#</a> 2、测试</h4> <p>下载<a href="https://www.getpostman.com/apps" target="_blank" rel="noopener noreferrer">POSTMAN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，并使用POSTMAN测试</p> <h5 id="_1、插入数据"><a href="#_1、插入数据" class="header-anchor">#</a> 1、插入数据</h5> <p>具体信息查看<a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_indexing_employee_documents.html" target="_blank" rel="noopener noreferrer">官方示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：PUT请求+请求体</p> <div class="language-json extra-class"><pre class="language-json"><code>PUT /megacorp/employee/<span class="token number">1</span>
<span class="token punctuation">{</span>
    <span class="token property">&quot;first_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;last_name&quot;</span> <span class="token operator">:</span>  <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;age&quot;</span> <span class="token operator">:</span>        <span class="token number">25</span><span class="token punctuation">,</span>
    <span class="token property">&quot;about&quot;</span> <span class="token operator">:</span>      <span class="token string">&quot;I love to go rock climbing&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;interests&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;sports&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;music&quot;</span> <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C01.postman.jpg" alt="01.postman"></p> <h5 id="_2、检索文档"><a href="#_2、检索文档" class="header-anchor">#</a> 2、检索文档</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_retrieving_a_document.html" target="_blank" rel="noopener noreferrer">官方示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET请求+URI+index+type+ID</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/1
</code></pre></div><p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C02.postmanget.jpg" alt="02.postmanget"></p> <h5 id="_3、轻量检索"><a href="#_3、轻量检索" class="header-anchor">#</a> 3、轻量检索</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_search_lite.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET请求+index+type+_search+条件（非必须）</p> <p>搜索所有雇员： <code>_search</code></p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search
</code></pre></div><p>高亮搜索：URL参数</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search?q=last_name:Smith
</code></pre></div><h5 id="_4、使用查询表达式"><a href="#_4、使用查询表达式" class="header-anchor">#</a> 4、使用查询表达式</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_search_with_query_dsl.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET+URI+index+type+_search+请求体【match】</p> <p>Query-string 搜索通过命令非常方便地进行临时性的即席搜索 ，但它有自身的局限性（参见 <a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/search-lite.html" target="_blank" rel="noopener noreferrer"><em>轻量</em> 搜索<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ）。Elasticsearch 提供一个丰富灵活的查询语言叫做 <em>查询表达式</em> ，它支持构建更加复杂和健壮的查询。</p> <p><em>领域特定语言</em> （DSL）， 指定了使用一个 JSON 请求。我们可以像这样重写之前的查询所有 Smith 的搜索 ：</p> <div class="language-json extra-class"><pre class="language-json"><code>GET /megacorp/employee/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;match&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;last_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>返回结果与之前的查询一样，但还是可以看到有一些变化。其中之一是，不再使用 <em>query-string</em> 参数，而是一个请求体替代。这个请求使用 JSON 构造，并使用了一个 <code>match</code> 查询（属于查询类型之一，后续将会了解）。</p> <h5 id="_5、更加复杂的查询"><a href="#_5、更加复杂的查询" class="header-anchor">#</a> 5、更加复杂的查询</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_more_complicated_searches.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET+URI+index+type+_search   + 请求体【match+filter】</p> <p>现在尝试下更复杂的搜索。 同样搜索姓氏为 Smith 的雇员，但这次我们只需要年龄大于 30 的。查询需要稍作调整，使用过滤器 <em>filter</em> ，它支持高效地执行一个结构化查询。</p> <div class="language-json extra-class"><pre class="language-json"><code>GET /megacorp/employee/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;match&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;last_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;smith&quot;</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token property">&quot;range&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">&quot;gt&quot;</span> <span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span> 
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><table><thead><tr><th><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_more_complicated_searches.html#CO4-1" target="_blank" rel="noopener noreferrer"><img src="https://www.elastic.co/guide/cn/elasticsearch/guide/current/images/icons/callouts/1.png" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></th> <th>这部分与我们之前使用的 <code>match</code> <em>查询</em> 一样。</th></tr></thead> <tbody><tr><td><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_more_complicated_searches.html#CO4-2" target="_blank" rel="noopener noreferrer"><img src="https://www.elastic.co/guide/cn/elasticsearch/guide/current/images/icons/callouts/2.png" alt="img"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>这部分是一个 <code>range</code> <em>过滤器</em> ， 它能找到年龄大于 30 的文档，其中 <code>gt</code> 表示_大于(_great than)。</td></tr></tbody></table> <p>目前无需太多担心语法问题，后续会更详细地介绍。只需明确我们添加了一个 <em>过滤器</em> 用于执行一个范围查询，并复用之前的 <code>match</code> 查询。现在结果只返回了一个雇员，叫 Jane Smith，32 岁。</p> <h5 id="_6、全文搜索"><a href="#_6、全文搜索" class="header-anchor">#</a> 6、全文搜索</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_full_text_search.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET+index+type+_search+请求体【match】  ==》看相关性得分</p> <p>截止目前的搜索相对都很简单：单个姓名，通过年龄过滤。现在尝试下稍微高级点儿的全文搜索——一项传统数据库确实很难搞定的任务。</p> <p>搜索下所有喜欢攀岩（rock climbing）的雇员：</p> <div class="language-json extra-class"><pre class="language-json"><code>GET /megacorp/employee/_search
<span class="token punctuation">{</span>
    <span class="token property">&quot;query&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;match&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;about&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;rock climbing&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>显然我们依旧使用之前的 <code>match</code> 查询在<code>about</code> 属性上搜索 “rock climbing” 。得到两个匹配的文档：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
   ...
   <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;total&quot;</span><span class="token operator">:</span>      <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span>  <span class="token number">0.16273327</span><span class="token punctuation">,</span>
      <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token punctuation">{</span>
            ...
            <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span>         <span class="token number">0.16273327</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;first_name&quot;</span><span class="token operator">:</span>  <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;last_name&quot;</span><span class="token operator">:</span>   <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;age&quot;</span><span class="token operator">:</span>         <span class="token number">25</span><span class="token punctuation">,</span>
               <span class="token property">&quot;about&quot;</span><span class="token operator">:</span>       <span class="token string">&quot;I love to go rock climbing&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;interests&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;sports&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;music&quot;</span> <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span><span class="token punctuation">,</span>
         <span class="token punctuation">{</span>
            ...
            <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span>         <span class="token number">0.016878016</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;first_name&quot;</span><span class="token operator">:</span>  <span class="token string">&quot;Jane&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;last_name&quot;</span><span class="token operator">:</span>   <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;age&quot;</span><span class="token operator">:</span>         <span class="token number">32</span><span class="token punctuation">,</span>
               <span class="token property">&quot;about&quot;</span><span class="token operator">:</span>       <span class="token string">&quot;I like to collect rock albums&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;interests&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;music&quot;</span> <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>&quot;_score&quot;:相关性得分</p></blockquote> <p>Elasticsearch 默认按照相关性得分排序，即每个文档跟查询的匹配程度。第一个最高得分的结果很明显：John Smith 的 <code>about</code> 属性清楚地写着 “rock climbing” 。</p> <p>但为什么 Jane Smith 也作为结果返回了呢？原因是她的 <code>about</code> 属性里提到了 “rock” 。因为只有 “rock” 而没有 “climbing” ，所以她的相关性得分低于 John 的。</p> <p>这是一个很好的案例，阐明了 Elasticsearch 如何 <em>在</em> 全文属性上搜索并返回相关性最强的结果。Elasticsearch中的 <em>相关性</em> 概念非常重要，也是完全区别于传统关系型数据库的一个概念，数据库中的一条记录要么匹配要么不匹配。</p> <h5 id="_7、短语搜索"><a href="#_7、短语搜索" class="header-anchor">#</a> 7、短语搜索</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_phrase_search.html" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET+index+type+_search+请求体【match_phrase 】</p> <p>找出一个属性中的独立单词是没有问题的，但有时候想要精确匹配一系列单词或者<em>短语</em> 。 比如， 我们想执行这样一个查询，仅匹配同时包含 “rock” <em>和</em> “climbing” ，<em>并且</em> 二者以短语 “rock climbing” 的形式紧挨着的雇员记录。</p> <p>为此对 <code>match</code> 查询稍作调整，使用一个叫做 <code>match_phrase</code> 的查询：</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search
{
    &quot;query&quot; : {
        &quot;match_phrase&quot; : {
            &quot;about&quot; : &quot;rock climbing&quot;
        }
    }
}
</code></pre></div><p>返回的信息</p> <div class="language- extra-class"><pre class="language-text"><code>{
   ...
   &quot;hits&quot;: {
      &quot;total&quot;:      1,
      &quot;max_score&quot;:  0.23013961,
      &quot;hits&quot;: [
         {
            ...
            &quot;_score&quot;:         0.23013961,
            &quot;_source&quot;: {
               &quot;first_name&quot;:  &quot;John&quot;,
               &quot;last_name&quot;:   &quot;Smith&quot;,
               &quot;age&quot;:         25,
               &quot;about&quot;:       &quot;I love to go rock climbing&quot;,
               &quot;interests&quot;: [ &quot;sports&quot;, &quot;music&quot; ]
            }
         }
      ]
   }
}
</code></pre></div><h5 id="_8、高亮搜索"><a href="#_8、高亮搜索" class="header-anchor">#</a> 8、高亮搜索</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/highlighting-intro.html" target="_blank" rel="noopener noreferrer">官方地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET+index+type+_search+请求体【match_phrase+highlight】==&gt;返回关键字加了em标签</p> <p>许多应用都倾向于在每个搜索结果中 <em>高亮</em> 部分文本片段，以便让用户知道为何该文档符合查询条件。在 Elasticsearch 中检索出高亮片段也很容易。</p> <p>再次执行前面的查询，并增加一个新的 <code>highlight</code> 参数：</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search
{
    &quot;query&quot; : {
        &quot;match_phrase&quot; : {
            &quot;about&quot; : &quot;rock climbing&quot;
        }
    },
    &quot;highlight&quot;: {
        &quot;fields&quot; : {
            &quot;about&quot; : {}
        }
    }
}
</code></pre></div><p>当执行该查询时，返回结果与之前一样，与此同时结果中还多了一个叫做 <code>highlight</code> 的部分。这个部分包含了 <code>about</code> 属性匹配的文本片段，并以 HTML 标签 <code>&lt;em&gt;&lt;/em&gt;</code> 封装：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
   ...
   <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;total&quot;</span><span class="token operator">:</span>      <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token property">&quot;max_score&quot;</span><span class="token operator">:</span>  <span class="token number">0.23013961</span><span class="token punctuation">,</span>
      <span class="token property">&quot;hits&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
         <span class="token punctuation">{</span>
            ...
            <span class="token property">&quot;_score&quot;</span><span class="token operator">:</span>         <span class="token number">0.23013961</span><span class="token punctuation">,</span>
            <span class="token property">&quot;_source&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;first_name&quot;</span><span class="token operator">:</span>  <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;last_name&quot;</span><span class="token operator">:</span>   <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;age&quot;</span><span class="token operator">:</span>         <span class="token number">25</span><span class="token punctuation">,</span>
               <span class="token property">&quot;about&quot;</span><span class="token operator">:</span>       <span class="token string">&quot;I love to go rock climbing&quot;</span><span class="token punctuation">,</span>
               <span class="token property">&quot;interests&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;sports&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;music&quot;</span> <span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token property">&quot;highlight&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
               <span class="token property">&quot;about&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                  <span class="token string">&quot;I love to go &lt;em&gt;rock&lt;/em&gt; &lt;em&gt;climbing&lt;/em&gt;&quot;</span> 
               <span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
         <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="_9、分析"><a href="#_9、分析" class="header-anchor">#</a> 9、分析</h5> <p><a href="https://www.elastic.co/guide/cn/elasticsearch/guide/current/_analytics.html#_analytics" target="_blank" rel="noopener noreferrer">官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>重点：GET+index+type+_search+请求体【aggs-field】</p> <blockquote><p>aggs：聚合</p></blockquote> <p>终于到了最后一个业务需求：支持管理者对雇员目录做分析。 Elasticsearch 有一个功能叫聚合（aggregations），允许我们基于数据生成一些精细的分析结果。聚合与 SQL 中的 <code>GROUP BY</code> 类似但更强大。</p> <p>举个例子，挖掘出雇员中最受欢迎的兴趣爱好：</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search
{
  &quot;aggs&quot;: {
    &quot;all_interests&quot;: {
      &quot;terms&quot;: { &quot;field&quot;: &quot;interests&quot; }
    }
  }
}
</code></pre></div><p>会报错</p> <p>Fielddata is disabled on text fields by default. Set fielddata=true on [inte</p> <p>默认情况下，字段数据在文本字段上禁用。设置字段数据= TRUE</p> <p>首先开启数据结构</p> <div class="language- extra-class"><pre class="language-text"><code>PUT megacorp/_mapping/employee/
{
  &quot;properties&quot;: {
    &quot;interests&quot;: { 
      &quot;type&quot;:     &quot;text&quot;,
      &quot;fielddata&quot;: true
    }
  }
}
</code></pre></div><p>然后在进行请求</p> <div class="language- extra-class"><pre class="language-text"><code>{
   ...
   &quot;hits&quot;: { ... },
   &quot;aggregations&quot;: {
      &quot;all_interests&quot;: {
         &quot;buckets&quot;: [
            {
               &quot;key&quot;:       &quot;music&quot;,
               &quot;doc_count&quot;: 2
            },
            {
               &quot;key&quot;:       &quot;forestry&quot;,
               &quot;doc_count&quot;: 1
            },
            {
               &quot;key&quot;:       &quot;sports&quot;,
               &quot;doc_count&quot;: 1
            }
         ]
      }
   }
}
</code></pre></div><p>可以看到，两位员工对音乐感兴趣，一位对林地感兴趣，一位对运动感兴趣。这些聚合并非预先统计，而是从匹配当前查询的文档中即时生成。</p> <p>如果想知道叫 Smith 的雇员中最受欢迎的兴趣爱好，可以直接添加适当的查询来组合查询：</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search
{
  &quot;query&quot;: {
    &quot;match&quot;: {
      &quot;last_name&quot;: &quot;smith&quot;
    }
  },
  &quot;aggs&quot;: {
    &quot;all_interests&quot;: {
      &quot;terms&quot;: {
        &quot;field&quot;: &quot;interests&quot;
      }
    }
  }
}
</code></pre></div><p><code>all_interests</code> 聚合已经变为只包含匹配查询的文档：</p> <div class="language- extra-class"><pre class="language-text"><code> ...
  &quot;all_interests&quot;: {
     &quot;buckets&quot;: [
        {
           &quot;key&quot;: &quot;music&quot;,
           &quot;doc_count&quot;: 2
        },
        {
           &quot;key&quot;: &quot;sports&quot;,
           &quot;doc_count&quot;: 1
        }
     ]
  }
</code></pre></div><p>聚合还支持分级汇总 。比如，查询特定兴趣爱好员工的平均年龄：</p> <div class="language- extra-class"><pre class="language-text"><code>GET /megacorp/employee/_search
{
    &quot;aggs&quot; : {
        &quot;all_interests&quot; : {
            &quot;terms&quot; : { &quot;field&quot; : &quot;interests&quot; },
            &quot;aggs&quot; : {
                &quot;avg_age&quot; : {
                    &quot;avg&quot; : { &quot;field&quot; : &quot;age&quot; }
                }
            }
        }
    }
}
</code></pre></div><p>输出基本是第一次聚合的加强版。依然有一个兴趣及数量的列表，只不过每个兴趣都有了一个附加的 <code>avg_age</code> 属性，代表有这个兴趣爱好的所有员工的平均年龄。</p> <p>即使现在不太理解这些语法也没有关系，依然很容易了解到复杂聚合及分组通过 Elasticsearch 特性实现得很完美。可提取的数据类型毫无限制。</p> <h3 id="_4、springboot-elasticsearch"><a href="#_4、springboot-elasticsearch" class="header-anchor">#</a> 4、SpringBoot+ElasticSearch</h3> <p>1、新建项目SpringBoot1.5+Web+Nosql--&gt;ElasticSearch</p> <p>2、springBoot默认支持两种技术和ES进行交互</p> <p>​	1、Jest【需要导入使用】</p> <p>​		利用JestClient和服务器的9200端口进行http通信</p> <p>​	2、SpringData ElasticSearch【默认】</p> <p>​		1）、客户端:Client节点信息: clusterNodes: clusterName</p> <p>​		2）、ElasticsearchTemplate操作es</p> <p>​		3）、编写ElasticsearchRepository子接口</p> <h4 id="_1、jest"><a href="#_1、jest" class="header-anchor">#</a> 1、Jest</h4> <p>1、注释SpringDataElasticSearch的依赖，并导入Jest【5.xx】的相关依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code>        <span class="token comment">&lt;!--   SpringData管理ElasticSearch   --&gt;</span>
<span class="token comment">&lt;!--        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;
        &lt;/dependency&gt;--&gt;</span>

        <span class="token comment">&lt;!-- https://mvnrepository.com/artifact/io.searchbox/jest --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.searchbox<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>jest<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>5.3.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>2、修改配置文件application.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
    <span class="token key atrule">jest</span><span class="token punctuation">:</span>
      <span class="token key atrule">uris</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//192.168.179.131<span class="token punctuation">:</span><span class="token number">9200</span>
</code></pre></div><p>3、创建 bean.Article</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>springboot<span class="token punctuation">.</span>bean</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>searchbox<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">JestId</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@JestId</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> autor<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> autor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAutor</span><span class="token punctuation">(</span><span class="token class-name">String</span> autor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>autor <span class="token operator">=</span> autor<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token class-name">String</span> title<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>title <span class="token operator">=</span> title<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setContent</span><span class="token punctuation">(</span><span class="token class-name">String</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4、运行程序</p> <p>5、编写Jest Cilent的测试类</p> <blockquote><p>向wdjr-article中插入数据</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">JestClient</span> jestClient<span class="token punctuation">;</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//1、给Es中索引（保存）一个文档</span>
    <span class="token class-name">Article</span> article <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Article</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;好消息&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article<span class="token punctuation">.</span><span class="token function">setAutor</span><span class="token punctuation">(</span><span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    article<span class="token punctuation">.</span><span class="token function">setContent</span><span class="token punctuation">(</span><span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//构建一个索引功能</span>
    <span class="token class-name">Index</span> index <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Index<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span>article<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token string">&quot;wdjr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">&quot;article&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token comment">//执行</span>
        jestClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>查询数据</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">search</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//查询表达式</span>
    <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token string">&quot;{\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;    \&quot;query\&quot; : {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        \&quot;match\&quot; : {\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;            \&quot;content\&quot; : \&quot;Hello\&quot;\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;        }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;    }\n&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot;}&quot;</span><span class="token punctuation">;</span>
    <span class="token comment">//构建搜索操作</span>
    <span class="token class-name">Search</span> search <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Search<span class="token punctuation">.</span>Builder</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addIndex</span><span class="token punctuation">(</span><span class="token string">&quot;wdjr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addType</span><span class="token punctuation">(</span><span class="token string">&quot;article&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//执行</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">SearchResult</span> result <span class="token operator">=</span> jestClient<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getJsonString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="_2、springdata-elastic"><a href="#_2、springdata-elastic" class="header-anchor">#</a> 2、SpringData-Elastic</h4> <p>1、下载对应版本的ElasticSearch</p> <p>如果版本不适配，会报错，解决方案：升级SpringBoot版本，或者安装合适的ES</p> <table><thead><tr><th>spring data elasticsearch</th> <th>elasticsearch</th></tr></thead> <tbody><tr><td>3.1.x</td> <td>6.2.2</td></tr> <tr><td>3.0.x</td> <td>5.5.0</td></tr> <tr><td>2.1.x</td> <td>2.4.0</td></tr> <tr><td>2.0.x</td> <td>2.2.0</td></tr> <tr><td>1.3.x</td> <td>1.5.2</td></tr></tbody></table> <p>2、在Docker中安装适合版本的ES【2.4.6】</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> pull elasticsearch:2.4.6
<span class="token function">docker</span> run <span class="token parameter variable">-e</span> <span class="token assign-left variable">ES_JAVA_OPTS</span><span class="token operator">=</span><span class="token string">&quot;-Xms256m -Xmx256m&quot;</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">9201</span>:9200 <span class="token parameter variable">-p</span> <span class="token number">9301</span>:9300 <span class="token parameter variable">--name</span> ES02 elasticsearch:2.4.6
</code></pre></div><p>3、编写配置文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">data</span><span class="token punctuation">:</span>
    <span class="token key atrule">elasticsearch</span><span class="token punctuation">:</span>
      <span class="token key atrule">cluster-name</span><span class="token punctuation">:</span> elasticsearch
      <span class="token key atrule">cluster-nodes</span><span class="token punctuation">:</span> 192.168.179.131<span class="token punctuation">:</span><span class="token number">9301</span>
</code></pre></div><p>4、运行主程序</p> <p>5、操作ElasticSearch有两种方式</p> <div class="language- extra-class"><pre><code>1）、编写一个ElasticsearchRepositry
</code></pre></div><p>​	2）、编写一个ElasticsearchTemplate</p> <p>6、ElasticsearchRepositry的操作</p> <p>1）、新建一个bean/Book类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Document</span><span class="token punctuation">(</span>indexName <span class="token operator">=</span> <span class="token string">&quot;wdjr&quot;</span><span class="token punctuation">,</span>type<span class="token operator">=</span><span class="token string">&quot;book&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Book</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> bookName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> auto<span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Book</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> bookName<span class="token punctuation">,</span> <span class="token class-name">String</span> auto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookName <span class="token operator">=</span> bookName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>auto <span class="token operator">=</span> auto<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getBookName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> bookName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setBookName</span><span class="token punctuation">(</span><span class="token class-name">String</span> bookName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>bookName <span class="token operator">=</span> bookName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getAuto</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> auto<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAuto</span><span class="token punctuation">(</span><span class="token class-name">String</span> auto<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>auto <span class="token operator">=</span> auto<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;Book{&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;id=&quot;</span> <span class="token operator">+</span> id <span class="token operator">+</span>
                <span class="token string">&quot;, bookName='&quot;</span> <span class="token operator">+</span> bookName <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token string">&quot;, auto='&quot;</span> <span class="token operator">+</span> auto <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>
                <span class="token char">'}'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2）、新建一个repositry/BookRepositry</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BookRepositry</span> <span class="token keyword">extends</span> <span class="token class-name">ElasticsearchRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Book</span><span class="token punctuation">,</span><span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token comment">//自定义查询方法</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Book</span><span class="token punctuation">&gt;</span></span> <span class="token function">findByBookNameLike</span><span class="token punctuation">(</span><span class="token class-name">String</span> bookName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3）、编写测试类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">BookRepositry</span> bookRepositry<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSearch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Book</span> book <span class="token operator">:</span> bookRepositry<span class="token punctuation">.</span><span class="token function">findByBookNameLike</span><span class="token punctuation">(</span><span class="token string">&quot;金&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="四、springboot的任务"><a href="#四、springboot的任务" class="header-anchor">#</a> 四、SpringBoot的任务</h2> <h2 id="五、springboot的安全"><a href="#五、springboot的安全" class="header-anchor">#</a> 五、SpringBoot的安全</h2> <h2 id="六、springboot的分布式"><a href="#六、springboot的分布式" class="header-anchor">#</a> 六、SpringBoot的分布式</h2> <h3 id="_1、dubbo简介"><a href="#_1、dubbo简介" class="header-anchor">#</a> 1、Dubbo简介</h3> <p><strong>1. Dubbo是什么？</strong></p> <p>dubbo就是个服务框架，如果没有分布式的需求，其实是不需要用的，只有在分布式的时候，才有dubbo这样的分布式服务框架的需求，并且本质上是个服务调用的东东，<strong>说白了就是个远程服务调用的分布式框架（告别Web Service模式中的WSdl，以服务者与消费者的方式在dubbo上注册）</strong></p> <p><strong>2. Dubbo能做什么？</strong></p> <p>1.透明化的远程方法调用，就像调用本地方法一样调用远程方法，只需简单配置，没有任何API侵入。</p> <p>2.软负载均衡及容错机制，可在内网替代F5等硬件负载均衡器，降低成本，减少单点。</p> <p>3.服务自动注册与发现，不再需要写死服务提供方地址，注册中心基于接口名查询服务提供者的IP地址，并且能够平滑添加或删除服务提供者。</p> <p><strong>3、docker的原理</strong></p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C03.dubbo.jpg" alt="03.dubbo"></p> <h4 id="调用关系说明"><a href="#调用关系说明" class="header-anchor">#</a> 调用关系说明：</h4> <ol start="0"><li><p>服务容器负责启动，加载，运行服务提供者。</p></li> <li><p>服务提供者在启动时，向注册中心注册自己提供的服务。</p></li> <li><p>服务消费者在启动时，向注册中心订阅自己所需的服务。</p></li> <li><p>注册中心返回服务提供者地址列表给消费者，如果有变更，注册中心将基于长连接推送变更数据给消费者。</p></li> <li><p>服务消费者，从提供者地址列表中，基于软负载均衡算法，选一台提供者进行调用，如果调用失败，再选另一台调用。</p></li> <li><p>服务消费者和提供者，在内存中累计调用次数和调用时间，定时每分钟发送一次统计数据到监控中心。</p></li></ol> <h3 id="_2、zookeeper"><a href="#_2、zookeeper" class="header-anchor">#</a> 2、Zookeeper</h3> <p>安装Zookeeper</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment">#安装zookeeper镜像</span>
<span class="token function">docker</span> pull registry.docker-cn.com/library/zookeeper
<span class="token comment">#运行zookeeper</span>
 <span class="token function">docker</span> run <span class="token parameter variable">--name</span> zk01  <span class="token parameter variable">--restart</span> always <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">2111</span>:2181 bf5cbc9d5cac
</code></pre></div><h3 id="_3、dubbo、zookeeper整合"><a href="#_3、dubbo、zookeeper整合" class="header-anchor">#</a> 3、Dubbo、Zookeeper整合</h3> <p>目的：完成<strong>服务消费者</strong>从注册中心查询调用<strong>服务生产者</strong></p> <p>1、将服务提供者注册到注册中心</p> <p>1）、引入dubbo和zkclient的相关依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>dubbo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.sgroschupf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>zkclient<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>2）、配置service服务，新建service.TicketService  和service.TicketServiceImp</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">TicketService</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Component</span>
<span class="token comment">//是dubbo包下的service</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TicketServiceImp</span> <span class="token keyword">implements</span> <span class="token class-name">TicketService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;《厉害了，我的国》&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3）、配置文件application.yml</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">dubbo</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> provider<span class="token punctuation">-</span>ticket
  <span class="token key atrule">registry</span><span class="token punctuation">:</span>
    <span class="token key atrule">address</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span>//192.168.179.131<span class="token punctuation">:</span><span class="token number">2111</span>
  <span class="token key atrule">scan</span><span class="token punctuation">:</span>
    <span class="token key atrule">base-packages</span><span class="token punctuation">:</span> com.wdjr.ticket.service
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9001</span>
</code></pre></div><p>4）、启动服务提供者</p> <p><strong>2、启动服务消费者</strong></p> <p>1）、引入Dubbo和Zookeeper的依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>dubbo-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.sgroschupf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>zkclient<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>2）、新建一个service.userService,并将TicketService的接口调用过来【全类名相同-包相同】</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C03.dubbo2.jpg" alt="03.dubbo2"></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>user<span class="token punctuation">.</span>service</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>dubbo<span class="token punctuation">.</span>config<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Reference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>wdjr<span class="token punctuation">.</span>ticket<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">TicketService</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Service</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Reference</span>
    <span class="token class-name">TicketService</span> ticketService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> ticket <span class="token operator">=</span> ticketService<span class="token punctuation">.</span><span class="token function">getTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;您已经成功买票：&quot;</span><span class="token operator">+</span>ticket<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3）、配置文件application.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">dubbo</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> comsumer<span class="token punctuation">-</span>user
  <span class="token key atrule">registry</span><span class="token punctuation">:</span>
    <span class="token key atrule">address</span><span class="token punctuation">:</span> zookeeper<span class="token punctuation">:</span>//192.168.179.131<span class="token punctuation">:</span><span class="token number">2111</span>
</code></pre></div><p>4）、编写测试类测试</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Autowired</span>
<span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    userService<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>结果展示：</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C04.dubbo+zk3.jpg" alt="04.dubbo+zk3"></p> <h3 id="_4、springcloud"><a href="#_4、springcloud" class="header-anchor">#</a> 4、SpringCloud</h3> <p>SpringCloud是一个分布式的整体解决方案，Spring Cloud为开发者提供了在分布式系统（配置管理，服务器发现，熔断，路由，微代理，控制总线，一次性token,全局锁，leader选举，分布式session，集群状态）中快速构建的工具，使用SpringCloud的开发者可以快速的驱动服务或者构建应用，同时能够和云平台资源进行对接。</p> <p><strong>SpringCloud分布式开发的五大常用组件</strong></p> <blockquote><p>Eureka:找到</p></blockquote> <ul><li>服务器发现 ——Netflix Eureka</li> <li>客服端负载均衡——Netflix Ribbon</li> <li>断路器——Netflix Hystrix 发现不了就及时断开</li> <li>服务网关——Netflix Zuul  过滤请求</li> <li>分布式配置——SpringCloud Config</li></ul> <p>目的：</p> <p>多个A服务调用多个B服务，负载均衡</p> <p>注册中心+服务提供者+服务消费者</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C05.springCloud.jpg" alt="05.springCloud"></p> <h5 id="_1、注册中心-eureka-server"><a href="#_1、注册中心-eureka-server" class="header-anchor">#</a> 1、注册中心（eureka-server）</h5> <p>1、新建Spring项目 ，SpringBoot1.5+Eureka Server</p> <p>2、编写application.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8761</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">hostname</span><span class="token punctuation">:</span> eureka<span class="token punctuation">-</span>server <span class="token comment">#实例的主机名</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">register-with-eureka</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment">#不把自己注册到euraka上</span>
    <span class="token key atrule">fetch-registry</span><span class="token punctuation">:</span> <span class="token boolean important">false</span> <span class="token comment">#不从euraka上来获取服务的注册信息</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8761/eureka/
</code></pre></div><p>3、编写主程序</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EnableEurekaServer</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">EurekaServerApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">EurekaServerApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="_2、服务提供者-provider-ticket"><a href="#_2、服务提供者-provider-ticket" class="header-anchor">#</a> 2、服务提供者（provider-ticket）</h5> <p>1、新建Spring项目，SpringBoot1.5+Eureka Discovery</p> <p>2、编写配置文件application.yml</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8002</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> provider<span class="token punctuation">-</span>ticket


<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment">#注册是服务使用IP地址</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8761/eureka/
</code></pre></div><p>3、创建一个售票的service</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TicketService</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;8001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;《厉害了，我的国》&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4、创建一个用于访问的controller</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TicketController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">TicketService</span> ticketService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/ticket&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> ticketService<span class="token punctuation">.</span><span class="token function">getTicket</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>5、完毕</p> <h5 id="_3、服务消费者-consumer-user"><a href="#_3、服务消费者-consumer-user" class="header-anchor">#</a> 3、服务消费者（consumer-user）</h5> <p>1、新建Spring项目，SpringBoot1.5+Eureka Discovery</p> <p>2、编写application.yml文件</p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> consumer<span class="token punctuation">-</span>user
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9001</span>
<span class="token key atrule">eureka</span><span class="token punctuation">:</span>
  <span class="token key atrule">instance</span><span class="token punctuation">:</span>
    <span class="token key atrule">prefer-ip-address</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
  <span class="token key atrule">client</span><span class="token punctuation">:</span>
    <span class="token key atrule">service-url</span><span class="token punctuation">:</span>
      <span class="token key atrule">defaultZone</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>8761/eureka/
</code></pre></div><p>3、编写一个controller</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">RestTemplate</span> restTemplate<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/buy&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">buyTicket</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> s <span class="token operator">=</span> restTemplate<span class="token punctuation">.</span><span class="token function">getForObject</span><span class="token punctuation">(</span><span class="token string">&quot;http://PROVIDER-TICKET/ticket&quot;</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> name<span class="token operator">+</span><span class="token string">&quot;购买了&quot;</span><span class="token operator">+</span><span class="token string">&quot;  &quot;</span><span class="token operator">+</span>s<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>4、编写主程序</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@EnableDiscoveryClient</span> <span class="token comment">//开启发现服务功能</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConsumerUserApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ConsumerUserApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@LoadBalanced</span> <span class="token comment">//使用负载均衡机制</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RestTemplate</span> <span class="token function">restTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RestTemplate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>5、完毕</p> <h5 id="_4、测试"><a href="#_4、测试" class="header-anchor">#</a> 4、测试</h5> <p>1、运行Eureka-server，provider-ticket【8002执行】(端口改为8001打成jar包，执行)，consumer-user</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C06.EurekaServer.jpg" alt="06.EurekaServer"></p> <p>2、provider-ticket</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C07.provider-ticket.jpg" alt="07.provider-ticket"></p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C07.provider-ticket02.jpg" alt="07.provider-ticket"></p> <p>3、consumer-user</p> <p><img src="E:%5C%E5%B7%A5%E4%BD%9C%E6%96%87%E6%A1%A3%5CSpringBoot%5Cimages2%5C08.consumer.jpg" alt="08.consumer"></p> <p>访问是以负载均衡的方式，所以每次都是 8001 。8002.轮询访问</p> <h2 id="七、springboot的监管"><a href="#七、springboot的监管" class="header-anchor">#</a> 七、SpringBoot的监管</h2></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2023/7/11 11:04:50</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/SpringBoot/尚硅谷SpringBoot/SpringBoot尚硅谷笔记.html" class="prev">
        一、Spring Boot 入门
      </a></span> <span class="next"><a href="/blog/SpringCloud/">
        Springcloud
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.5c484a50.js" defer></script><script src="/blog/assets/js/3.8dc6c122.js" defer></script><script src="/blog/assets/js/426.50769ad5.js" defer></script>
  </body>
</html>
