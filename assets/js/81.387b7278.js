(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{1055:function(s,a,t){"use strict";t.r(a);var n=t(14),c=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_106-nacos集群-架构说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_106-nacos集群-架构说明"}},[s._v("#")]),s._v(" 106_Nacos集群_架构说明")]),s._v(" "),a("p",[s._v("真实业务场景:")]),s._v(" "),a("p",[a("img",{attrs:{src:t(539),alt:"image-20220103231001983"}})]),s._v(" "),a("p",[s._v("用户请求 通过nginx集群路由到 Nacos集群,  nacos使用同一份数据(持久化到Mysql数据库)")]),s._v(" "),a("p",[s._v("按照上述，"),a("strong",[s._v("我们需要mysql数据库")]),s._v("。")]),s._v(" "),a("p",[s._v("默认Nacos使用嵌入式数据库实现数据的存储。所以，如果启动多个默认配置下的Nacos节点，数据存储是存在一致性问题的。为了解决这个问题，Nacos采用了集中式存储的方式来支持集群化部署，目前只支持MySQL的存储。")]),s._v(" "),a("p",[s._v("Nacos支持三种部署模式")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("单机模式-用于测试和单机试用。\n集群模式-用于生产环境，确保高可用。\n多集群模式-用于多数据中心场景。\n")])])]),a("p",[s._v("Windows")]),s._v(" "),a("p",[s._v("cmd startup.cmd或者双击startup.cmd文件")]),s._v(" "),a("p",[s._v("单机模式支持mysql")]),s._v(" "),a("p",[s._v("在0.7版本之前，在单机模式时nacos使用嵌入式数据库实现数据的存储，不方便观察数据存储的基本情况。0.7版本增加了支持mysql数据源能力，具体的操作步骤:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("安装数据库，版本要求:5.6.5+\n初始化mysq数据库，数据库初始化文件: nacos-mysql.sql\n修改conf/application.properties文件，增加支持mysql数据源配置（目前只支持mysql)，添加mysql数据源的url、用户名和密码。\n")])])]),a("p",[s._v("nacos  -- application.properties文件相关配置")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("spring.datasource.platform=mysql\n\ndb.num=1\ndb.url.0=jdbc:mysql://127.0.0.1:3306/nacos_config?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true\ndb.user=root\ndb.password=XXXX\n\n")])])]),a("p",[s._v("再以单机模式启动nacos，nacos所有写嵌入式数据库的数据都写到了mysql。")])])}),[],!1,null,null,null);a.default=c.exports},539:function(s,a,t){s.exports=t.p+"assets/img/20220103231002.327bbbb0.png"}}]);