(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{1084:function(e,n,t){"use strict";t.r(n);var a=t(14),i=Object(a.a)({},(function(){var e=this,n=e._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h2",{attrs:{id:""}},[n("a",{staticClass:"header-anchor",attrs:{href:"#"}},[e._v("#")])]),e._v(" "),n("p",[e._v("OpenFeign 写上注解之后会找配置的服务名暴露的相应方法")]),e._v(" "),n("p",[n("strong",[e._v("超时设置，故意设置超时演示出错情况")])]),e._v(" "),n("p",[e._v("1.服务提供方8001/8002故意写暂停程序")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('    //Feign故意超时3s\n    @GetMapping(value = "/payment/feign/timeout")\n    public String paymentFeignTimeout()\n    {\n        // 业务逻辑处理正确，但是需要耗费3秒钟\n        try {\n            TimeUnit.SECONDS.sleep(3);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        //返回端口\n        return serverPort;\n    }\n')])])]),n("p",[e._v("2.服务消费方80添加超时方法PaymentFeignService")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('    //访问Feign故意超时3s的接口\n    @GetMapping(value = "/payment/feign/timeout")\n    public String paymentFeignTimeout();\n')])])]),n("p",[e._v("3.服务消费方80添加超时方法OrderFeignController")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('    //消费侧 Feign故意超时测试\n    @GetMapping(value = "/consumer/payment/feign/timeout")\n    public String paymentFeignTimeout() {\n        //openfeign-ribbon ,默认等待一秒  超过一秒就报错\n        return paymentFeignService.paymentFeignTimeout();\n\n    }\n')])])]),n("p",[e._v("4.测试：")]),e._v(" "),n("p",[e._v("多次刷新http://localhost/consumer/payment/feign/timeout")]),e._v(" "),n("p",[e._v("将会跳出错误Spring Boot默认错误页面，主要异常：feign.RetryableException:Read timed out executing GET http://CLOUD-PAYMENT-SERVCE/payment/feign/timeout。")]),e._v(" "),n("p",[e._v("OpenFeign默认等待1秒钟，超过后报错")]),e._v(" "),n("p",[n("img",{attrs:{src:t(567),alt:"image-20211227004130689"}})]),e._v(" "),n("p",[n("strong",[e._v("YML文件里需要开启OpenFeign客户端超时控制")]),e._v(" -- 由ribbon进行限制")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("#设置feign客户端超时时间(OpenFeign默认支持ribbon)(单位：毫秒)\nribbon:\n  #指的是建立连接所用的时间，适用于网络状况正常的情况下,两端连接所用的时间, 此时5s\n  ReadTimeout: 5000\n  #指的是建立连接后从服务器读取到可用资源所用的时间\n  ConnectTimeout: 5000\n\n")])])])])}),[],!1,null,null,null);n.default=i.exports},567:function(e,n,t){e.exports=t.p+"assets/img/20211227004130.28cb3d20.png"}}]);