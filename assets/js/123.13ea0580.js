(window.webpackJsonp=window.webpackJsonp||[]).push([[123],{706:function(a,t,s){"use strict";s.r(t);var e=s(14),r=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"windows环境设置mysql数据库自动备份"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#windows环境设置mysql数据库自动备份"}},[a._v("#")]),a._v(" windows环境设置mysql数据库自动备份")]),a._v(" "),t("h2",{attrs:{id:"_00、背景介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_00、背景介绍"}},[a._v("#")]),a._v(" 00、背景介绍")]),a._v(" "),t("p",[a._v("客户使用的是mysql数据库，虽然大部分数据库客户端工具都具有备份功能，但并不能做到定期自动备份；在Windows环境下，手工备份MySQL是很繁琐的，所以我们\n要实现数据库的自动备份就需要一下两步：")]),a._v(" "),t("ul",[t("li",[a._v("利用MySQL提供的备份命令mysqldump")]),a._v(" "),t("li",[a._v("结合Windows的任务计划程序")])]),a._v(" "),t("h2",{attrs:{id:"_01、实现步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_01、实现步骤"}},[a._v("#")]),a._v(" 01、实现步骤")]),a._v(" "),t("h3",{attrs:{id:"_1、编写脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、编写脚本"}},[a._v("#")]),a._v(" 1、编写脚本")]),a._v(" "),t("ul",[t("li",[a._v("说明：此方法可以不用关闭数据库，并且可以按每一天备份的时间来命名备份文件。")])]),a._v(" "),t("p",[a._v("新建一个数据库备份文件的存放目录，如：D:\\mysql_backup\n注意：目录地址中不要带空格！\n新建一个批处理文件，如：mysql_backup_tool.bat，文件内容如下：")]),a._v(" "),t("p",[a._v("注: 查询mysql安装路径")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v('show variables like "%char%";\n')])])]),t("p",[a._v("D:\\Environment\\mysql-8.0.25\\mysql-8.0.25-winx64\\bin")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210085702.png",alt:"image-20220210085655478"}})]),a._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[a._v("rem ******MySQL backup start******\n    @echo off\n    \n    ::删除一周前的备份数据\n    forfiles /p "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"d:\\mysql_backup"')]),a._v(" /m backup_*.sql "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-7")]),a._v(" /c "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cmd /c del /f @path"')]),a._v("\n    \n    ::设置时间变量\n    "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Ymd=%date:~,4%%date:~5,2%%date:~8,2%"')]),a._v(" \n    \n    ::进入mysql安装目录的bin目录下cd D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("mysql-8.0.25"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("mysql-8.0.25-winx64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("bin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n    \n    ::执行备份操作\n    D:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("Environment"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("mysql-8.0.25"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("mysql-8.0.25-winx64"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("bin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("mysqldump "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--opt")]),a._v(" --single-transaction"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("TRUE "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--user")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("root "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--password")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("Qianyan89892528 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--host")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--protocol")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("tcp "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--port")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(" --default-character-set"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8 --single-transaction"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("TRUE "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--routines")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--events")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"nacos_config"')]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" d:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("mysql_backup"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("backup_%Ymd%.sql\n    \n    @echo on\n    rem ******MySQL backup end******\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("1. forfiles 为删除过期文件的命令，-d -7 删除7天的文件；\n2. 关于时间参数的参考：\n\t\t%date:~0,10%      //提取年月日信息\n        %date:~-3%         //提取星期几信息\n        %time:~0,5%         //提取时间中的时和分\n        %time:~0,-3%       //提取时和分和秒信息\n3. mysqldump 为MySQL提供的备份命令，该命令所在目录为MySQL安装目录下的bin文件夹中，此处直接使用该命令的前提是该命令所在bin文件夹已被设置为系统环境变量，如未设置，则要写全路径；\n4. –user=root 为 MySQL 用户名；\n5. –password=root 为 MySQL 密码；\n6. –host=127.0.0.1 为 MySQL 主机名；\n7. “nacos_config” 为要备份的数据库的名称；\n8. backup_%Ymd%.sql 是根据当前时间规则生成备份文件的名称。\n")])])]),t("h2",{attrs:{id:"_02、添加定时任务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_02、添加定时任务"}},[a._v("#")]),a._v(" 02、添加定时任务")]),a._v(" "),t("p",[a._v("我们进入服务器管理面板，点击右上角菜单栏中的“工具”，选择其中的“任务计划程序”：")]),a._v(" "),t("p",[a._v("控制面板 -- 管理工具--任务计划程序")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210091359.png",alt:"image-20220210091359548"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210092257.png",alt:"image-20220210092256969"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210091450.png",alt:"image-20220210091450286"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210092324.png",alt:"image-20220210092324372"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210091517.png",alt:"image-20220210091517605"}})]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210092119.png",alt:"image-20220210092119685"}})]),a._v(" "),t("p",[a._v("完成这些步骤后，windows会给我们看一下整个任务的概述信息：")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210092357.png",alt:"image-20220210092357654"}})]),a._v(" "),t("p",[a._v("确定无误之后，点击“完成”就可以了。此时我们就会看到在Windows的任务列表里，多了一条新的任务：")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210092504.png",alt:"image-20220210092504655"}})]),a._v(" "),t("p",[a._v("至此，在Windows环境下自动备份MySQL的设置就全部完成了。")]),a._v(" "),t("p",[a._v("顺便展示下备份测试结果：(由于第一次经验不足，导致备份失败，修复完问题 9:50成功备份)")]),a._v(" "),t("p",[a._v("注意： 如果测试脚本是否可行，可直接点击进行查看数据是否正常备份")]),a._v(" "),t("p",[t("img",{attrs:{src:"https://gitee.com/zouyu0310/images/raw/master/img/20220210095022.png",alt:"image-20220210095022264"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);