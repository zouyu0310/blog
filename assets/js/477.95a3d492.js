(window.webpackJsonp=window.webpackJsonp||[]).push([[477],{1140:function(t,e,n){"use strict";n.r(e);var a=n(14),r=Object(a.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"本地程序-审批静态页面-nginx部署"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#本地程序-审批静态页面-nginx部署"}},[t._v("#")]),t._v(" 本地程序--审批静态页面（nginx部署）")]),t._v(" "),e("h2",{attrs:{id:"场景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#场景"}},[t._v("#")]),t._v(" 场景")]),t._v(" "),e("p",[t._v("客户方： 外网8000端口--\x3e 映射到本机88端口，现在需要使用审批功能")]),t._v(" "),e("h2",{attrs:{id:"准备工具"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#准备工具"}},[t._v("#")]),t._v(" 准备工具")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("nginx安装包")])]),t._v(" "),e("li",[e("p",[t._v("审批静态页面（pro1服务器/usr/local/nginx/html地址下）geecityform和geecityoa")])])]),t._v(" "),e("p",[e("img",{attrs:{src:"https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/LAJdl6GpyyQmnke1/img/5f05e514-ce23-45d4-bd86-2ca48f25b9e1.png",alt:"image"}})]),t._v(" "),e("h2",{attrs:{id:"客户本地安装nginx"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#客户本地安装nginx"}},[t._v("#")]),t._v(" 客户本地安装nginx")]),t._v(" "),e("h2",{attrs:{id:"更换本地程序为任意端口-如89"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更换本地程序为任意端口-如89"}},[t._v("#")]),t._v(" 更换本地程序为任意端口 如89")]),t._v(" "),e("h2",{attrs:{id:"将上述静态文件放到nginx安装目录下html文件中"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#将上述静态文件放到nginx安装目录下html文件中"}},[t._v("#")]),t._v(" 将上述静态文件放到nginx安装目录下html文件中")]),t._v(" "),e("h2",{attrs:{id:"修改nginx配置信息如下"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#修改nginx配置信息如下"}},[t._v("#")]),t._v(" 修改nginx配置信息如下")]),t._v(" "),e("ol",[e("li",[e("p",[t._v("监听端口listen 80; -> 88")])]),t._v(" "),e("li",[e("p",[t._v("监听域名 改为客户域名")])]),t._v(" "),e("li",[e("p",[t._v("location块中 proxy_pass改为客户后端程序地址 如 "),e("a",{attrs:{href:"http://127.0.0.1:89/",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:89/"),e("OutboundLink")],1)])]),t._v(" "),e("li",[e("p",[t._v("location ^~/geecityoa 中可看情况修改为绝对地址")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v("#SssS程序\n")])])]),e("p",[t._v("server {")]),t._v(" "),e("h1",{attrs:{id:"监听外部端口"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#监听外部端口"}},[t._v("#")]),t._v(" 监听外部端口")]),t._v(" "),e("p",[t._v("listen 80;")]),t._v(" "),e("h1",{attrs:{id:"监听域名"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#监听域名"}},[t._v("#")]),t._v(" 监听域名")]),t._v(" "),e("p",[t._v("server_name   pms.89892528.com;")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[t._v('#新版 小程序版 公众号接口获取地址\nlocation /yezhuxiaochengxujiekou/apiBase/api {\n    proxy_pass http://20.89892528.cn:8889/api;\n}\n#新版 小程序版 公众号上传图片接口获取地址\nlocation /yezhuxiaochengxujiekou/apiBase {\n    proxy_pass http://20.89892528.cn:8889;\n}\n\nlocation ~ (.+?export) {\n\t# 本地程序地址\n\t#proxy_pass   http://127.0.0.1:8888;\n\tproxy_pass   http://saas-servers2;\n\t# 响应超时时间\n\tproxy_read_timeout  3600;\n\t# 超时时间\n\tfastcgi_connect_timeout 300;  \n\tfastcgi_send_timeout  300;  \n\tfastcgi_read_timeout  300; \n\tfastcgi_buffers 8  16k;\n\tfastcgi_buffer_size  32k;\n\tproxy_set_header  X-Real-IP  $remote_addr;\n\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\tproxy_redirect off;\n\tproxy_set_header Host $host;\n\tproxy_set_header X-Real-IP       $remote_addr;\n\tproxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;\n\tclient_max_body_size  100M;\t\n\t# websocket support\n\tproxy_http_version 1.1;\n\tproxy_set_header Upgrade $http_upgrade;\n\tproxy_set_header Connection "upgrade";\n\tlimit_rate 200k;\n}\n\n# 微信路径\nlocation  ~* \\.(txt)$  {\nroot   /data/wechat/;\n}\n\n\t\n# 默认访问路径 /\nlocation / {\n\t# 本地程序地址\n\t#proxy_pass   http://127.0.0.1:8888/;\n\tproxy_pass   http://saas-servers;\n\t# 响应超时时间\n\tproxy_read_timeout  3600;\n\t# 超时时间\n\tfastcgi_connect_timeout 300;  \n\tfastcgi_send_timeout  300;  \n\tfastcgi_read_timeout  300; \n\tfastcgi_buffers 8  16k;\n\tfastcgi_buffer_size  32k;\n\tproxy_set_header  X-Real-IP  $remote_addr;\n\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\tproxy_redirect off;\n\tproxy_set_header Host $host;\n\tproxy_set_header X-Real-IP       $remote_addr;\n\tproxy_set_header X-Forwarded-For  $proxy_add_x_forwarded_for;\n\tclient_max_body_size  100M;\t\n\t# websocket support\n\tproxy_http_version 1.1;\n\tproxy_set_header Upgrade $http_upgrade;\n\tproxy_set_header Connection "upgrade";\n}\n\n\nlocation ^~/hot-area {\n\talias   html/hot-area;\n\ttry_files $uri $uri/ /hot-area/index.html;\n\tindex index.html;\n}\n\t\n\nlocation ^~/geecityoa {\n\talias   html/geecityoa;\n\ttry_files $uri $uri/ /geecityoa/index.html;\n\tindex index.html;\n}\n\t\n#表单页面\nlocation ^~/geecityform {\n\t#nginx文件夹下的目录\n\talias html/geecityform;\n\t#入口页面配置\n\ttry_files $uri $uri/ /geecityform/index.html;\n\tindex index.html;\n}\n# 驾驶舱前端页面\nlocation ^~/cockpit {\n\talias   html/cockpit;\n\t#index  index.html index.htm break;\n\ttry_files $uri $uri/ /cockpit/index.html;\n\tindex index.html;\n}\n\n# 驾驶舱接口\nlocation ^~/kanbanApi {\n\trewrite ^/kanbanApi/(.*) /$1 break;  \n\tproxy_pass   http://pms.89892528.com/spectaculars/;\n}\n\n\n\n# 新版 小程序版公众号页面\nlocation ^~/yezhuxiaochengxu {\n\talias   html/yezhuxiaochengxu;\n\t#index  index.html index.htm break;\n\ttry_files $uri $uri/ /yezhuxiaochengxu/index.html;\n\tindex index.html;\n}\n')])])]),e("p",[t._v("}")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);