(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{1081:function(n,e,r){"use strict";r.r(e);var t=r(14),a=Object(t.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h2",{attrs:{id:"_44-openfeign服务调用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_44-openfeign服务调用"}},[n._v("#")]),n._v(" 44_OpenFeign服务调用")]),n._v(" "),e("p",[e("strong",[n._v("接口+注解")]),n._v("：微服务调用接口 + @FeignClient")]),n._v(" "),e("p",[n._v("1.新建cloud-consumer-feign-order80")]),n._v(" "),e("p",[n._v("2.POM")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('<?xml version="1.0" encoding="UTF-8"?>\n<project xmlns="http://maven.apache.org/POM/4.0.0"\n         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">\n    <parent>\n        <artifactId>cloud2021</artifactId>\n        <groupId>com.springcloud</groupId>\n        <version>1.0-SNAPSHOT</version>\n    </parent>\n    <modelVersion>4.0.0</modelVersion>\n\n    <artifactId>cloud-consumer-feign-order80</artifactId>\n\n\n    <dependencies>\n        \x3c!--openfeign--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-openfeign</artifactId>\n        </dependency>\n        \x3c!--eureka client--\x3e\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n        </dependency>\n        \x3c!-- 引入自己定义的api通用包，可以使用Payment支付Entity --\x3e\n        <dependency>\n            <groupId>com.springcloud</groupId>\n            <artifactId>cloud-api-commons</artifactId>\n            <version>${project.version}</version>\n        </dependency>\n        \x3c!--web--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-actuator</artifactId>\n        </dependency>\n        \x3c!--一般基础通用配置--\x3e\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-devtools</artifactId>\n            <scope>runtime</scope>\n            <optional>true</optional>\n        </dependency>\n        <dependency>\n            <groupId>org.projectlombok</groupId>\n            <artifactId>lombok</artifactId>\n            <optional>true</optional>\n        </dependency>\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-test</artifactId>\n            <scope>test</scope>\n        </dependency>\n    </dependencies>\n\n</project>\n')])])]),e("p",[n._v("3.YML")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("server:\n  port: 81\n\neureka:\n  client:\n    register-with-eureka: false\n    service-url:\n#      客户端认eureka集群\n      defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/\n\n")])])]),e("ol",{attrs:{start:"4"}},[e("li",[n._v("主启动")])]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("package com.springcloud;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.cloud.openfeign.EnableFeignClients;\n\n/**\n * @ClassName OrderFeignMain80\n * @Description\n * @Author zouyu\n * @Date 2021/12/27 0:07\n * @Version 1.0\n **/\n\n//组件添加:使用+激活\n@SpringBootApplication\n@EnableFeignClients //使用+激活\npublic class OrderFeignMain80 {\n    public static void main(String[] args){\n        SpringApplication.run(OrderFeignMain80.class,args);\n    }\n}\n\n")])])]),e("p",[n._v("5.业务类")]),n._v(" "),e("p",[n._v("业务逻辑接口+@FeignClient配置调用provider服务")]),n._v(" "),e("p",[n._v("新建PaymentFeignService接口并新增注解@FeignClient")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('@Component\n@FeignClient(value = "CLOUD-PAYMENT-SERVICE") //找哪个微服务\npublic interface PaymentFeignService {\n\n    //拿到8001中的接口\n    @GetMapping(value = "/payment/get/{id}")\n    public CommonResult<Payment> getPaymentById(@PathVariable("id") Long id);\n}\n\n')])])]),e("p",[n._v("5.5 controller")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('package com.springcloud.controller;\n\nimport com.springcloud.entities.CommonResult;\nimport com.springcloud.entities.Payment;\nimport com.springcloud.service.PaymentFeignService;\nimport org.springframework.stereotype.Controller;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport javax.annotation.Resource;\n\n/**\n * @ClassName OrderFeignController\n * @Description Feign 对外服务接口\n * @Author zouyu\n * @Date 2021/12/27 0:17\n * @Version 1.0\n **/\n@RestController\npublic class OrderFeignController {\n\n    @Resource\n    private PaymentFeignService paymentFeignService;\n\n    @GetMapping(value = "/consumer/payment/get/{id}")\n    public CommonResult<Payment> getPaymentById(@PathVariable("id") Long id)\n    {\n        return paymentFeignService.getPaymentById(id);\n    }\n\n}\n\n')])])]),e("p",[n._v("6.测试")]),n._v(" "),e("p",[n._v("先启动2个eureka集群7001/7002")]),n._v(" "),e("p",[n._v("再启动2个微服务8001/8002")]),n._v(" "),e("p",[n._v("启动OpenFeign启动")]),n._v(" "),e("p",[n._v("http://localhost/consumer/payment/get/1")]),n._v(" "),e("p",[n._v("Feign自带负载均衡配置项")]),n._v(" "),e("p",[n._v("小结:")]),n._v(" "),e("p",[e("img",{attrs:{src:r(564),alt:"image-20211227002830585"}})])])}),[],!1,null,null,null);e.default=a.exports},564:function(n,e,r){n.exports=r.p+"assets/img/20211227002830.9f8457c2.png"}}]);