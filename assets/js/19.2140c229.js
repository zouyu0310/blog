(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{376:function(t,a){t.exports="data:image/png;base64,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"},377:function(t,a,s){t.exports=s.p+"assets/img/image-20210605093027167.4a62f6bd.png"},378:function(t,a,s){t.exports=s.p+"assets/img/image-20210605094655827.9dc19d30.png"},379:function(t,a,s){t.exports=s.p+"assets/img/image-20210605161138255.b51226bb.png"},380:function(t,a,s){t.exports=s.p+"assets/img/20220109113646.866d7c63.png"},381:function(t,a,s){t.exports=s.p+"assets/img/20220109114012.79acd0f0.png"},786:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("ul",[a("li",[a("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%8D%B7"}},[t._v("什么是数据卷")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E4%BD%BF%E7%94%A8%E6%95%B0%E6%8D%AE%E5%8D%B7"}},[t._v("使用数据卷")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E6%8C%87%E4%BB%A4-v-%E6%96%B9%E5%BC%8F"}},[t._v("指令 v 方式")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E6%96%87%E4%BB%B6-docker-file-%E6%96%B9%E5%BC%8F"}},[t._v("文件 Docker File 方式")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E5%8C%BF%E5%90%8D%E5%92%8C%E5%85%B7%E5%90%8D%E6%8C%82%E8%BD%BD"}},[t._v("匿名和具名挂载")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"#%E5%8C%BF%E5%90%8D%E6%8C%82%E8%BD%BD"}},[t._v("匿名挂载")])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E5%85%B7%E5%90%8D%E6%8C%82%E8%BD%BD"}},[t._v("具名挂载")])])])]),t._v(" "),a("li",[a("a",{attrs:{href:"#%E6%95%B0%E6%8D%AE%E5%8D%B7%E5%AE%B9%E5%99%A8"}},[t._v("数据卷容器")])])]),t._v(" "),a("h2",{attrs:{id:"什么是数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是数据卷"}},[t._v("#")]),t._v(" 什么是数据卷")]),t._v(" "),a("p",[t._v("数据卷(Data Volume)  - 将docker容器内的数据保存进宿主机的磁盘中")]),t._v(" "),a("p",[a("strong",[t._v("docker的理念回顾：")])]),t._v(" "),a("p",[t._v("将应用和运行的环境打包形成容器运行，运行可以伴随着容器，但是我们对于数据的要求，是希望能够 持久化的！")]),t._v(" "),a("p",[t._v("就好比，你安装一个MySQL，结果你把容器删了，就相当于删库跑路了，这TM也太扯了吧！")]),t._v(" "),a("p",[t._v("所以我们希望容器之间有可能可以共享数据，Docker容器产生的数据，如果不通过 docker commit 生成新的镜像，使得数据作为镜像的一部分保存下来，那么当容器删除后，数据自然也就没有了！这样是行不通的！")]),t._v(" "),a("p",[t._v("为了能保存数据在Docker中我们就可以使用卷！让数据挂载到我们本地！这样数据就不会因为容器删除而丢失了！")]),t._v(" "),a("p",[a("strong",[t._v("作用：")])]),t._v(" "),a("p",[t._v("卷就是目录或者文件，存在一个或者多个容器中，由 docker 挂载到容器，但不属于联合文件系统，因此能够绕过 Union File System ， 提供一些用于持续存储或共享数据的特性。")]),t._v(" "),a("p",[t._v("卷的设计目的就是数据的持久化，完全独立于容器的生存周期，因此 Docker 不会在容器删除时删除其挂载的数据卷。")]),t._v(" "),a("p",[a("strong",[t._v("特点：")])]),t._v(" "),a("ol",[a("li",[t._v("数据卷可在容器之间共享或重用数据")]),t._v(" "),a("li",[t._v("卷中的更改可以直接生效")]),t._v(" "),a("li",[t._v("数据卷中的更改不会包含在镜像的更新中")]),t._v(" "),a("li",[t._v("数据卷的生命周期一直持续到没有容器使用它为止")])]),t._v(" "),a("p",[t._v("一句话： 就是容器的持久化，以及容器间的继承和数据共享！")]),t._v(" "),a("h2",{attrs:{id:"使用数据卷"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用数据卷"}},[t._v("#")]),t._v(" 使用数据卷")]),t._v(" "),a("h3",{attrs:{id:"指令-v-方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#指令-v-方式"}},[t._v("#")]),t._v(" 指令 v 方式")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"},[t._v("方式一：容器中直接使用命令来添加")])]),a("p",[t._v("在用 docker run 命令的时候，使用 -v 标记来创建一个数据卷并挂载到容器里。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" 宿主机绝对路径目录:容器内目录 镜像名\n")])])]),a("p",[t._v("测试：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /home/d-test:/home centos /bin/bash\n")])])]),a("p",[t._v("查看数据卷是否挂载成功 docker inspect 容器id")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker ps")]),t._v("\nCONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES\n05fa819084c9   centos    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/bin/bash"')]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" seconds ago   Up "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(" seconds             friendly_keller\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  docker inspect 05fa819084c9")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:s(376),alt:"image-20210605090028768"}})]),t._v(" "),a("ul",[a("li",[t._v("测试容器和宿主机之间数据共享：可以发现，在容器中，创建的会在宿主机中看到！")])]),t._v(" "),a("p",[t._v("容器：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@05fa819084c9 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nbin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  s\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@05fa819084c9 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd home")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@05fa819084c9 home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@05fa819084c9 home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# touch test.java")]),t._v("\n")])])]),a("p",[t._v("主机：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /home/d-test")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos d-test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\ntest.java\n")])])]),a("ul",[a("li",[t._v("测试容器停止退出后，主机修改数据是否会同步！")])]),t._v(" "),a("ol",[a("li",[t._v("停止容器")]),t._v(" "),a("li",[t._v("在宿主机上修改文件，增加些内容")]),t._v(" "),a("li",[t._v("启动刚才停止的容器")]),t._v(" "),a("li",[t._v("然后查看对应的文件，发现数据依旧同步！")])]),t._v(" "),a("p",[t._v("主机：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos d-test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\ntest.java\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos d-test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# touch new.java")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos d-test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nnew.java  test.java\n")])])]),a("p",[t._v("容器：")]),t._v(" "),a("p",[a("code",[t._v("docker ps -a")]),t._v(" 查看所有容器")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker start 05fa819084c9")]),t._v("\n05fa819084c9\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker attach 05fa819084c9")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@05fa819084c9 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /home")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@05fa819084c9 home"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nnew.java  test.java\n")])])]),a("p",[t._v("::: note 安装 mysql 测试")]),t._v(" "),a("p",[t._v(":::")]),t._v(" "),a("p",[t._v("1、安装")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull mysql:5.7\n")])])]),a("p",[t._v("2、启动容器 ，-e 为环境变量")]),t._v(" "),a("p",[t._v("mysql 的数据不应该放在容器内，应放主机内！先体验下 -v 挂载卷！")]),t._v(" "),a("p",[t._v("参考官方文档")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3310")]),t._v(":3306 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /home/mysql/conf:/etc/mysql/conf.d "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /home/mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123456")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" mysql01 mysql:5.7\n")])])]),a("p",[t._v("连接 mysql 并创建一个数据库")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# mysql -h 127.0.0.1 -P 3310 -u root -p")]),t._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" create database "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nQuery OK, "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" row affected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00")]),t._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" show databases"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Database           "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" information_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" mysql              "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" performance_schema "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" sys                "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("\n+--------------------+\n"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" rows "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.00")]),t._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("p",[a("img",{attrs:{src:s(377),alt:"image-20210605093027167"}})]),t._v(" "),a("h3",{attrs:{id:"文件-docker-file-方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#文件-docker-file-方式"}},[t._v("#")]),t._v(" 文件 Docker File 方式")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"},[t._v("方式二：通过Docker File 来添加")])]),a("p",[t._v("DockerFile 是用来构建Docker镜像的构建文件，是由一些列命令和参数构成的脚本。")]),t._v(" "),a("p",[t._v("这里先了解体验一下，后面有详细介绍")]),t._v(" "),a("p",[a("strong",[t._v("1、编写DockerFile文件")])]),t._v(" "),a("p",[t._v("我们在宿主机 /home 目录下新建一个 docker-test-volume文件夹")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" docker-test-volume\n")])])]),a("p",[t._v("出于可移植和分享的考虑，之前使用的 "),a("code",[t._v("-v 主机目录:容器目录")]),t._v(" 这种方式不能够直接在 DockerFile 中实现。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos docker-test-volume"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# pwd")]),t._v("\n/home/docker-test-volume\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos docker-test-volume"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# vim dockerfile1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos docker-test-volume"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cat dockerfile1")]),t._v("\nFROM centos\nVOLUME "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dataVolumeContainer1"')]),t._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/dataVolumeContainer2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nCMD "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-------end------"')]),t._v("\nCMD /bin/bash\n")])])]),a("p",[t._v("说明：在编写DockerFile文件中使用 VOLUME 来给镜像添加一个或多个数据卷")]),t._v(" "),a("p",[a("strong",[t._v("2、build生成镜像")])]),t._v(" "),a("p",[t._v("build生成镜像，获得一个新镜像 test-centos，注意最后面有个 "),a("code",[t._v(".")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" /home/docker-test-volume/dockerfile1 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" test-centos "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n")])])]),a("p",[t._v("然后启动容器：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" test-centos /bin/bash\n")])])]),a("p",[a("img",{attrs:{src:s(378),alt:"image-20210605094655827"}})]),t._v(" "),a("p",[t._v("通过上述步骤，容器内的卷目录地址就已经知道了，但是对应的主机目录地址在哪里呢？")]),t._v(" "),a("p",[a("strong",[t._v("3、查看数据目录")])]),t._v(" "),a("p",[t._v("我们在数据卷中新建一个文件")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@93343e21a67b /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd dataVolumeContainer1")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@93343e21a67b dataVolumeContainer1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# touch container.txt")]),t._v("\n")])])]),a("p",[t._v("查看下这个容器的信息")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" inspect 93343e21a67b\n")])])]),a("p",[t._v("可以看到挂载的路径")]),t._v(" "),a("p",[a("img",{attrs:{src:s(379),alt:"image-20210605161138255"}})]),t._v(" "),a("p",[t._v("在主机目录里看到之前在容器里创建的文件")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd /var/lib/docker/volumes/7adb0e2e33503b17abfd453fded4b0cd9d9e8b05e064d248dc47de0da6456788/_data")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos _data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\ncontainer.txt\n")])])]),a("p",[t._v("注意：如果访问出现了 cannot open directory: Permission denied")]),t._v(" "),a("p",[t._v("解决办法：在挂载目录后多加一个 --privileged=true参数即可")]),t._v(" "),a("h2",{attrs:{id:"匿名和具名挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匿名和具名挂载"}},[t._v("#")]),t._v(" 匿名和具名挂载")]),t._v(" "),a("h3",{attrs:{id:"匿名挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#匿名挂载"}},[t._v("#")]),t._v(" 匿名挂载")]),t._v(" "),a("p",[a("code",[t._v("-v 容器内路径")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-P")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" nginx01 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /etc/nginx nginx\n")])])]),a("p",[t._v("可通过命令 "),a("code",[t._v("docker volume ls")]),t._v(" 查看挂载的列表")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker volume ls")]),t._v("\nDRIVER    VOLUME NAME\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     4d0221bc0d8b9e44fb2e878cd3efcacb9b4bd51c8e135d79c549f7a6345f3a24\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     7a1e6924fed1cc5ea6a386d9b2542c0ffc53fada1755bc7d09601274dff6ddd0\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     7adb0e2e33503b17abfd453fded4b0cd9d9e8b05e064d248dc47de0da6456788\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     adaa3053cb2ff95afc7bab51451f4b1167aa1b9056398ed44b0d4cae9580db52\n")])])]),a("p",[t._v("这些没指定名字的都是匿名挂载，我们 -v 只写了容器内路径，并没写容器外路径")]),t._v(" "),a("p",[t._v("挂载目录是： "),a("code",[t._v("/var/lib/docker/volumes/VOLUME-NAME/_data")])]),t._v(" "),a("p",[t._v("匿名挂载的缺点，就是不好维护，不清楚目录挂载的是哪个容器")]),t._v(" "),a("h3",{attrs:{id:"具名挂载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#具名挂载"}},[t._v("#")]),t._v(" 具名挂载")]),t._v(" "),a("p",[a("code",[t._v("-v 卷名:/容器内路径")])]),t._v(" "),a("p",[t._v("例如取名为 juming 来挂载")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -d -P --name nginx02 -v juming:/etc/nginx nginx")]),t._v("\n112f36599f077eada56197c22dd3b3a3eaba2e5bb38bf2cb19adc783163991e7\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker volume ls")]),t._v("\nDRIVER    VOLUME NAME\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     4d0221bc0d8b9e44fb2e878cd3efcacb9b4bd51c8e135d79c549f7a6345f3a24\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     7a1e6924fed1cc5ea6a386d9b2542c0ffc53fada1755bc7d09601274dff6ddd0\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     7adb0e2e33503b17abfd453fded4b0cd9d9e8b05e064d248dc47de0da6456788\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     adaa3053cb2ff95afc7bab51451f4b1167aa1b9056398ed44b0d4cae9580db52\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("local")]),t._v("     juming\n")])])]),a("p",[t._v("查看挂载的目录："),a("code",[t._v("docker volume VOLUME-NAME")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker volume inspect juming")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CreatedAt"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-06-05T16:32:10+08:00"')]),t._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Driver"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local"')]),t._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Labels"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" null,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Mountpoint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/lib/docker/volumes/juming/_data"')]),t._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"juming"')]),t._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Options"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" null,\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Scope"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"local"')]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),a("p",[a("mark",[t._v("挂载操作中，没指定目录名情况下，默认在 "),a("code",[t._v("/var/lib/docker/volumes/")]),t._v(" 目录下")])]),t._v(" "),a("ul",[a("li",[t._v("改变文件的读写权限")])]),t._v(" "),a("p",[t._v("指定容器对我们挂载出来的内容的读写权限")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-P")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" nginx02 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" nginxconfig:/etc/nginx:ro nginx\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-P")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" nginx02 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" nginxconfig:/etc/nginx:rw nginx\n")])])]),a("p",[t._v("ro: readonly 只读")]),t._v(" "),a("p",[t._v("rw: readwrite 可读可写")]),t._v(" "),a("h2",{attrs:{id:"数据卷容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据卷容器"}},[t._v("#")]),t._v(" 数据卷容器")]),t._v(" "),a("p",[t._v("之前的是主机和容器之间共享数据，那么如何实现容器和容器之间的共享数据呢？")]),t._v(" "),a("p",[t._v("命名的容器挂载数据卷，其他容器通过挂载这个（父容器）实现数据共享，挂载数据卷的容器，称之为"),a("strong",[t._v("数据卷容器(Data Volume Container)")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"},[t._v("测试容器间传递共享")])]),a("p",[t._v("使用之前的镜像："),a("code",[t._v("test-centos")]),t._v(" 为模板，运行容器 docker01（父容器），docker02，docker03")]),t._v(" "),a("p",[t._v("他们都会具有容器卷 "),a("code",[t._v("/dataVolumeContainer1")]),t._v(" 和 "),a("code",[t._v("/dataVolumeContainer2")])]),t._v(" "),a("p",[a("strong",[t._v("1、先启动一个父容器docker01，然后在 dataVolumeContainer2 新增文件")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos _data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it --name docker01 test-centos")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@cd87cb3eb33b /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls -l")]),t._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),t._v("\nlrwxrwxrwx   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" Nov  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" bin -"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" usr/bin\ndrwxr-xr-x   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Jun  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" 08:56 dataVolumeContainer1\ndrwxr-xr-x   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4096")]),t._v(" Jun  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" 08:56 dataVolumeContainer2\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@cd87cb3eb33b /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd dataVolumeContainer2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@cd87cb3eb33b dataVolumeContainer2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# touch docker01.txt")]),t._v("\n")])])]),a("p",[t._v("退出且不停止容器运行："),a("code",[t._v("ctrl+P+Q")])]),t._v(" "),a("p",[a("strong",[t._v("2、创建docker02，docker03 让他们继承docker01")])]),t._v(" "),a("p",[t._v("可以看到 docker01 创建的文件存在")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos _data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it --name docker02 --volumes-from docker01 test-centos")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@f81238516f65 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  cd dataVolumeContainer2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@f81238516f65 dataVolumeContainer2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\ndocker01.txt\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@f81238516f65 dataVolumeContainer2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# touch docker02.txt")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos _data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# docker run -it --name docker03 --volumes-from docker01 test-centos")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@c8c41a2a0831 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\nbin  dataVolumeContainer1  dataVolumeContainer2  dev  etc  home  lib  lib64  lost+found  media\tmnt  opt  proc\troot  run  sbin  srv  sys  tmp\tusr  var\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@c8c41a2a0831 /"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# cd dataVolumeContainer2")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@c8c41a2a0831 dataVolumeContainer2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls")]),t._v("\ndocker01.txt  docker02.txt\n\n")])])]),a("p",[a("strong",[t._v("3、回到docker01发现可以看到 02 和 03 添加的共享文件")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@VM-0-6-centos ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#  docker attach docker01")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("root@cd87cb3eb33b dataVolumeContainer2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# ls -l")]),t._v("\ntotal "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" Jun  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" 08:56 docker01.txt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" Jun  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" 08:58 docker02.txt\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" Jun  "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(" 09:00 docker03.txt\n")])])]),a("p",[t._v("删除 docker01 后 ，docker02 修改文件后， docker03 还可以正常共享数据")]),t._v(" "),a("p",[t._v("容器之间配置信息的传递，数据卷的生命周期一直持续到没有容器使用它为止。 存储在本机的文件则会一直保留！")]),t._v(" "),a("h2",{attrs:{id:"补充"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#补充"}},[t._v("#")]),t._v(" 补充")]),t._v(" "),a("p",[t._v("注意: 坑：容器卷记得加入")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("--privileged=true\n")])])]),a("blockquote",[a("p",[t._v("Docker挂载主机目录访问如果出现cannot open directory .: Permission denied\n解决办法：在挂载目录后多加一个--privileged=true参数即可")]),t._v(" "),a("p",[t._v("如果是CentOS7安全模块会比之前系统版本加强，不安全的会先禁止，所以目录挂载的情况被默认为不安全的行为，\n在SELinux里面挂载目录被禁止掉了额，如果要开启，我们一般使用--privileged=true命令，扩大容器的权限解决挂载目录没有权限的问题，也即\n使用该参数，container内的root拥有真正的root权限，否则，container内的root只是外部的一个普通用户权限。")])]),t._v(" "),a("p",[a("img",{attrs:{src:s(380),alt:"image-20220109113639188"}})]),t._v(" "),a("p",[t._v("运行一个带有容器卷存储功能的容器实例")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker run -it --privileged=true -v /宿主机绝对路径目录:/容器内目录      镜像名\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("*  将运用与运行的环境打包镜像，run后形成容器实例运行 ，但是我们对数据的要求希望是持久化的\n \nDocker容器产生的数据，如果不备份，那么当容器实例删除后，容器内的数据自然也就没有了。\n为了能保存数据在docker中我们使用卷。\n \n特点：\n1：数据卷可在容器之间共享或重用数据\n2：卷中的更改可以直接实时生效，爽\n3：数据卷中的更改不会包含在镜像的更新中\n4：数据卷的生命周期一直持续到没有容器使用它为止\n")])])]),a("h2",{attrs:{id:"案例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[t._v("#")]),t._v(" 案例")]),t._v(" "),a("p",[t._v("宿主vs容器之间映射添加容器卷 -- 注意: 如果两个路径下都没有目录，docker会进行新建")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v(" docker run -it --privileged=true -v /宿主机绝对路径目录:/容器内目录      镜像名\n")])])]),a("p",[t._v("查看数据卷是否挂载成功")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker inspect 容器ID\n")])])]),a("p",[a("img",{attrs:{src:s(381),alt:"image-20220109114012524"}})]),t._v(" "),a("p",[t._v("容器和宿主机之间数据共享")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("1  docker修改，主机同步获得 \n2 主机修改，docker同步获得\n3 docker容器stop，主机修改，docker容器重启看数据是否同步。\n")])])]),a("h2",{attrs:{id:"卷的继承和共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#卷的继承和共享"}},[t._v("#")]),t._v(" 卷的继承和共享")]),t._v(" "),a("p",[t._v("容器1完成和宿主机的映射")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker run -it  --privileged=true -v /mydocker/u:/tmp --name u1 ubuntu\n")])])]),a("p",[t._v("容器2继承容器1的卷规则")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker run -it  --privileged=true --volumes-from 父类名  --name u2 ubuntu\n")])])]),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("docker run -d -p 89:8888  --privileged=true -v /mydocker/geecitydocker0109:/geecitydocker0109  --name geecitydocker0109  272d794bef77\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);