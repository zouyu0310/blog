(window.webpackJsonp=window.webpackJsonp||[]).push([[462],{1119:function(t,e,a){"use strict";a.r(e);var n=a(14),i=Object(n.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("hr"),t._v(" "),e("p",[t._v("问题背景\n需要从yml配置文件中读取参数，写了一个config实体类，添加了GET，SET方法，再别的类中@Autowired注入这个配置类的时候报空指针。")]),t._v(" "),e("p",[t._v("问题原因 一\n1、不能在定时任务中调用别的类 2、不能new一个类。\n然后注入值，因为定时任务会开启一个新的进程，而spring值会注入到初始的类中，但这个有值类并没有被使用，而是调用了无值的类。")]),t._v(" "),e("p",[t._v("问题原因 二  初始化顺序")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("成员变量初始化 -> Constructor -> @Autowired\n")])])]),e("p",[t._v("调用get时候，还没有进入autowired的生命周期，自然为空，获取不到值，报空指针错误。")]),t._v(" "),e("h2",{attrs:{id:"解决方案"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[t._v("#")]),t._v(" 解决方案")]),t._v(" "),e("p",[t._v("引入工具类")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('/**\n * @author yichuan@iscas.ac.cn\n * 此工具类用于从Spring的上下文中去获取到类，解决@autowird注入空指针的问题\n * @version 1.0\n * @date 2020/10/27 16:54\n */\n@Component\npublic class ApplicationContextHelperUtil implements ApplicationContextAware {\n    private static ApplicationContext applicationContext;\n    @Override\n    public void setApplicationContext( ApplicationContext applicationContext1 ) throws BeansException {\n        applicationContext = applicationContext1;\n    }\n\n    public static ApplicationContext getApplicationContext(){\n        return applicationContext;\n    }\n\n    @SuppressWarnings("unchecked")\n    public static <T> T getBean(Class<T> clazz) {\n        return (T) applicationContext.getBean(clazz);\n    }\n}\n\n\n')])])]),e("p",[t._v("同时调用方法由")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("@Autowired\nHeartbeatConfig heartbeatConfig;\n")])])]),e("p",[t._v("改为")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("private static HeartbeatConfig heartbeatConfig =(HeartbeatConfig) ApplicationContextHelperUtil.getBean(HeartbeatConfig.class);\n")])])]),e("p",[t._v("参考:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("https://blog.csdn.net/wenyichuan/article/details/109315211?spm=1001.2101.3001.6650.1&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-109315211-blog-128559132.235%5Ev32%5Epc_relevant_increate_t0_download_v2&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-1-109315211-blog-128559132.235%5Ev32%5Epc_relevant_increate_t0_download_v2&utm_relevant_index=2\n")])])])])}),[],!1,null,null,null);e.default=i.exports}}]);