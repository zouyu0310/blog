(window.webpackJsonp=window.webpackJsonp||[]).push([[479],{1139:function(t,s,e){"use strict";e.r(s);var o=e(14),_=Object(o.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"mysql占用服务器cpu过高的处理办法"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql占用服务器cpu过高的处理办法"}},[t._v("#")]),t._v(" MySQL占用服务器CPU过高的处理办法")]),t._v(" "),s("ol",[s("li",[s("p",[s("strong",[t._v("出现原因 ：")]),t._v(" 查询大量数据、SQL语句关联表较多，数据库表没加索引")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("查询问题：")])])])]),t._v(" "),s("p",[t._v("查询语句")]),t._v(" "),s("blockquote",[s("p",[t._v("select * from information_schema.processlist  where COMMAND = 'Query' order by TIME DESC;")])]),t._v(" "),s("p",[t._v("打印完整的info  SQL")]),t._v(" "),s("blockquote",[s("p",[t._v("show processlist")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://alidocs.oss-cn-zhangjiakou.aliyuncs.com/res/7jP2lRGwLY93n8g5/img/a0eb979f-8af1-43b8-913e-fa40eef498a5.png",alt:"image"}})]),t._v(" "),s("p",[t._v("第一列 id，一个标识，你要kill一个语句的时候很有用。")]),t._v(" "),s("p",[t._v("第二列 user列，显示单前用户，如果不是root，这个命令就只显示你权限范围内的sql语句。")]),t._v(" "),s("p",[t._v("第三列 host列，显示这个语句是从哪个ip的哪个端口上发出的。可以用来追踪出问题语句的用户。")]),t._v(" "),s("p",[t._v("第四列 db列，显示这个进程目前连接的是哪个数据库。")]),t._v(" "),s("p",[t._v("第五列 command列，显示当前连接的执行的命令，一般就是休眠（sleep），查询（query），连接（connect）。")]),t._v(" "),s("p",[t._v("第六列 time列，此这个状态持续的时间，单位是秒。")]),t._v(" "),s("p",[t._v("第七列 state列，显示使用当前连接的sql语句的状态，很重要的列，请注意，state只是语句执行中的某一个状态，一个sql语句，已查询为例，可能需要经过copying to tmp table，Sorting result，Sending data等状态才可以完成。")]),t._v(" "),s("p",[t._v("第八列 info列，显示这个sql语句，因为长度有限，所以长的sql语句就显示不全，但是一个判断问题语句的重要依据。")]),t._v(" "),s("ol",{attrs:{start:"3"}},[s("li",[t._v("**解决方法：**杀死数据库执行语句进程")])]),t._v(" "),s("blockquote",[s("p",[t._v("-- 杀掉运行时间在600秒以上的链接，拼接得到kill语句")])]),t._v(" "),s("blockquote",[s("p",[t._v("select concat('KILL ',id,';') from information_schema.`processlist`  where command = 'Query'  and info like 'select %' and time > 600")])]),t._v(" "),s("p",[t._v("得到相关语句后复制出来执行即可。")]),t._v(" "),s("p",[t._v("**注：**只可以杀死select开头的语句！！！")]),t._v(" "),s("p",[s("strong",[t._v("注：")]),t._v(" 可自行百度 MySQL explain关键字的详细介绍--用于优化SQL语句")])])}),[],!1,null,null,null);s.default=_.exports}}]);