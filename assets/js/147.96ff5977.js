(window.webpackJsonp=window.webpackJsonp||[]).push([[147],{738:function(t,s,a){"use strict";a.r(s);var n=a(14),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"mongodb安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mongodb安装"}},[t._v("#")]),t._v(" MongoDB安装")]),t._v(" "),s("h3",{attrs:{id:"参考文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文档"}},[t._v("#")]),t._v(" 参考文档")]),t._v(" "),s("p",[t._v("官网下载："),s("a",{attrs:{href:"https://www.mongodb.com/try/download/community",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.mongodb.com/try/download/community"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("官网文档："),s("a",{attrs:{href:"https://docs.mongodb.com/v3.6/administration/install-community/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.mongodb.com/v3.6/administration/install-community/"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("菜鸟教程："),s("a",{attrs:{href:"https://www.runoob.com/mongodb/mongodb-window-install.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.runoob.com/mongodb/mongodb-window-install.html"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"以docker为例安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#以docker为例安装"}},[t._v("#")]),t._v(" 以Docker为例安装")]),t._v(" "),s("p",[t._v("1、拉取镜像")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull mongo:latest\n")])])]),s("p",[t._v("注意：有的服务器不支持新版本，会导致Docker启动失败，具体原因看报错内容")]),t._v(" "),s("p",[t._v("可选择其他版本（我使用的服务器5.0及以上版本都不可使）")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" pull mongo:4.4.8\n")])])]),s("p",[t._v("2、创建和启动容器")]),t._v(" "),s("p",[t._v("以 4.4.8 版本为例 "),s("Badge",{attrs:{text:"建议加上密码，原因看下方"}})],1),t._v(" "),s("code-group",[s("code-block",{attrs:{title:"不带密码启动",active:""}},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("always  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" mymongo "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v(":27017 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /data/docker/mongodb:/data/db "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  mongo:4.4.8\n")])])])]),t._v(" "),s("code-block",{attrs:{title:"带密码启动"}},[s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-d")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--restart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("always "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" mymongo "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27017")]),t._v(":27017  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MONGO_INITDB_ROOT_USERNAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("mymongoadmin "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-e")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("MONGO_INITDB_ROOT_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("root123456 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-v")]),t._v(" /data/docker/mongodb:/data/db "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n  mongo:4.4.8\n")])])])])],1),t._v(" "),s("p",[t._v("使用账户密码启动的，需要给数据库创建用户权限：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.createUser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        user:"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"admin"')]),t._v(",\n        pwd:"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"root123456"')]),t._v(",\n        roles:"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("role:"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dbOwner"')]),t._v(",db:"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"yygh_hosp"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("之后sping中MongoDB地址改成：")]),t._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[t._v("spring.data.mongodb.uri")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[t._v("mongodb://admin:root123456@IP:端口/yygh_hosp")]),t._v("\n")])])]),s("p",[t._v("角色权限说明(role)：")]),t._v(" "),s("p",[t._v("Built-In Roles（内置角色）：")]),t._v(" "),s("ol",[s("li",[t._v("数据库用户角色：read、readWrite;")]),t._v(" "),s("li",[t._v("数据库管理角色：dbAdmin、dbOwner、userAdmin；")]),t._v(" "),s("li",[t._v("集群管理角色：clusterAdmin、clusterManager、clusterMonitor、hostManager；")]),t._v(" "),s("li",[t._v("备份恢复角色：backup、restore；")]),t._v(" "),s("li",[t._v("所有数据库角色：readAnyDatabase、readWriteAnyDatabase、userAdminAnyDatabase、dbAdminAnyDatabase")]),t._v(" "),s("li",[t._v("超级用户角色：root")])]),t._v(" "),s("blockquote",[s("p",[t._v("这里还有几个角色间接或直接提供了系统超级用户的访问")]),t._v(" "),s("p",[t._v("（dbOwner 、userAdmin、userAdminAnyDatabase）")])]),t._v(" "),s("Badge",{attrs:{text:"带密码原因：",type:"error",vertical:"middle"}}),t._v(" "),s("p",[t._v("之前学习 "),s("a",{attrs:{href:"https://www.bilibili.com/video/BV1V5411K7rT?p=163",target:"_blank",rel:"noopener noreferrer"}},[t._v("尚硅谷-尚医通项目"),s("OutboundLink")],1),t._v(" 用到了MongoDB")]),t._v(" "),s("p",[t._v("我安装到了服务器上，没换端口地址且没设密码")]),t._v(" "),s("p",[t._v("后来某一天，数据库让淦了，所有数据都没了，只剩下个勒索数据：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210911115120977.png",alt:"image-20210911115120977"}})]),t._v(" "),s("p",[t._v("翻译后：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210911115316142.png",alt:"image-20210911115316142"}})]),t._v(" "),s("p",[t._v("还好只是学习的测试数据，不然就完犊子了")]),t._v(" "),s("p",[t._v("百度了一下参考了 "),s("a",{attrs:{href:"https://blog.csdn.net/u013513053/article/details/105785980/",target:"_blank",rel:"noopener noreferrer"}},[t._v("mongoDB 数据莫名其妙的没了"),s("OutboundLink")],1),t._v(" 这篇文章，才知道数据库是被黑了")]),t._v(" "),s("h2",{attrs:{id:"连接和建库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连接和建库"}},[t._v("#")]),t._v(" 连接和建库")]),t._v(" "),s("p",[t._v("默认保留的数据库")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("admin")]),t._v(": 从权限角度考虑, 这是 "),s("code",[t._v("root")]),t._v(" 数据库, 如果将一个用户添加到这个数据库, 这个用户自动继承所有数据库的权限, 一些特定的服务器端命令也只能从这个数据库运行, 比如列出所有的数据库或者关闭服务器")]),t._v(" "),s("li",[s("strong",[t._v("local")]),t._v(": 数据永远不会被复制, 可以用来存储限于本地的单台服务器的集合 (部署集群, 分片等)")]),t._v(" "),s("li",[s("strong",[t._v("config")]),t._v(": Mongo 用于分片设置时, "),s("code",[t._v("config")]),t._v(" 数据库在内部使用, 用来保存分片的相关信息")])]),t._v(" "),s("p",[t._v("进入容器")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-it")]),t._v(" mymongo /bin/bash \n")])])]),s("p",[t._v("连接mongo")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("mongo "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" mymongoadmin "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" root123456\n")])])]),s("p",[t._v("基本操作：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#查看所有数据库")]),t._v("\nshow dbs\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#使用数据库，没有这个数据则自动创建")]),t._v("\nuse testdb\n")])])]),s("p",[t._v("当 "),s("code",[t._v("use testdb")]),t._v(" 的时候. "),s("code",[t._v("testdb")]),t._v(" 其实存放在内存之中,")]),t._v(" "),s("p",[t._v("当 "),s("code",[t._v("testdb")]),t._v(" 中存在一个 document 之后, mongo 才会将这个数据库持久化到硬盘之中.")]),t._v(" "),s("h2",{attrs:{id:"文档基本-crud"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文档基本-crud"}},[t._v("#")]),t._v(" 文档基本 CRUD")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"title"},[t._v("官方文档")]),s("p",[t._v("https://docs.mongodb.com/manual/crud/")])]),s("h3",{attrs:{id:"插入"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#插入"}},[t._v("#")]),t._v(" 插入")]),t._v(" "),s("ul",[s("li",[t._v("图例")])]),t._v(" "),s("p",[s("code",[t._v("users")]),t._v(' 为要插入的"表"')]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-3.png",alt:"img"}})]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#向集合中添加一个文档")]),t._v("\ndb.inventory.insertOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"canvas"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", tags: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cotton"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35.5")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#向集合中添加多个文档")]),t._v("\ndb.inventory.insertMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", tags: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blank"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"red"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mat"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),t._v(", tags: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gray"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27.9")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35.5")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mousepad"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", tags: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"gel"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"blue"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("注：当我们向 "),s("code",[t._v("inventory")]),t._v(" 中插入 "),s("code",[t._v("document")]),t._v(" 文档时, 如果没有给文档指定 "),s("code",[t._v("_id")]),t._v(" 属性, 那么数据库会为文档自动添加 "),s("code",[t._v("_id")]),t._v(" field, 并且值类型是 "),s("code",[t._v("ObjectId(blablabla)")]),t._v(", 就是文档的唯一标识, 类似于 relational database 里的 "),s("code",[t._v("primary key")])]),t._v(" "),s("p",[t._v("这个数据库工具叫 "),s("strong",[t._v("Navicat")])]),t._v(" "),s("blockquote",[s("p",[t._v("“Navicat”是一套可创建多个连接的数据库管理工具，用以方便管理 MySQL、Oracle、PostgreSQL、SQLite、SQL Server、MariaDB 和/或 MongoDB 等不同类型的数据库，并支持管理某些云数据库，例如阿里云、‎腾讯云。")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/image-20210915173925342.png",alt:"image-20210915173925342"}})]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("mongo 中的数字, 默认情况下是 double 类型, 如果要存整型, 必须使用函数 "),s("code",[t._v("NumberInt(整型数字)")]),t._v(", 否则取出来就有问题了")]),t._v(" "),s("li",[t._v("插入当前日期可以使用 "),s("code",[t._v("new Date()")])])])]),t._v(" "),s("p",[t._v("如果某条数据插入失败, 将会终止插入, 但已经插入成功的数据"),s("strong",[t._v("不会回滚掉")]),t._v(". 因为批量插入由于数据较多容易出现失败, 因此, 可以使用 "),s("code",[t._v("try catch")]),t._v(" 进行异常捕捉处理, 测试的时候可以不处理.如：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("try "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  db.comment.insertMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"articleid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100001"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"我们不应该把清晨浪费在手机上, 健康很重要, 一杯温水幸福你我 他."')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1002"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nickname"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"相忘于江湖"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"createdatetime"')]),t._v(":new Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019-0805T22:08:15.522Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"likenum"')]),t._v(":NumberInt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"articleid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100001"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"我夏天空腹喝凉开水, 冬天喝温开水"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1005"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nickname"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"伊人憔 悴"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"createdatetime"')]),t._v(":new Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019-08-05T23:58:51.485Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"likenum"')]),t._v(":NumberInt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("888")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"articleid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100001"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"我一直喝凉开水, 冬天夏天都喝."')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1004"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nickname"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"杰克船 长"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"createdatetime"')]),t._v(":new Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019-08-06T01:05:06.321Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"likenum"')]),t._v(":NumberInt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("666")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"4"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"articleid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100001"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"专家说不能空腹吃饭, 影响健康."')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1003"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nickname"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"凯 撒"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"createdatetime"')]),t._v(":new Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019-08-06T08:18:35.288Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"likenum"')]),t._v(":NumberInt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"articleid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"100001"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"content"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"研究表明, 刚烧开的水千万不能喝, 因为烫 嘴."')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1003"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"nickname"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"凯撒"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"createdatetime"')]),t._v(":new Date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2019-0806T11:01:02.521Z"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"likenum"')]),t._v(":NumberInt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"state"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" catch "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  print "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查询"}},[t._v("#")]),t._v(" 查询")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-4.png",alt:"img"}})]),t._v(" "),s("ul",[s("li",[t._v("使用 "),s("code",[t._v("db.<collection_name>.find()")]),t._v(" 方法对集合进行查询, 接受一个 json 格式的查询条件. 返回的是一个"),s("strong",[t._v("数组")])]),t._v(" "),s("li",[s("code",[t._v("db.<collection_name>.findOne()")]),t._v(" 查询集合中符合条件的第一个文档, 返回的是一个"),s("strong",[t._v("对象")])])]),t._v(" "),s("p",[t._v("查询全部数据：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.inventory.find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("数据准备：")])]),t._v(" "),s("p",[t._v("先删除之前的数据：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.comment.deleteMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("我们先往 comment 插入一些数据：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.comment.insertMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notebook"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"planner"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcard"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("45")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.25")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("ul",[s("li",[t._v("可以使用 "),s("code",[t._v("$in")]),t._v(" 操作符表示：查看状态是 A 和 D 的")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.comment.find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$in")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("多个查询条件用逗号分隔, 表示 "),s("code",[t._v("AND")]),t._v(" 的关系")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('db.comment.find( { status: "A", qty: { $lt: 30 } } )\n')])])]),s("p",[t._v("等价于sql : "),s("code",[t._v('SELECT * FROM comment WHERE status = "A" AND qty < 30')])]),t._v(" "),s("ul",[s("li",[t._v("使用 "),s("code",[t._v("$or")]),t._v(" 操作符表示后边数组中的条件是OR的关系")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.comment.find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$or")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("等价于sql : "),s("code",[t._v('SELECT * FROM inventory WHERE status = "A" OR qty < 30')])]),t._v(" "),s("ul",[s("li",[t._v("可以使用 "),s("code",[t._v("pretty()")]),t._v(" 来帮助阅读")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.comment.find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".pretty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("创建索引")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.posts.createIndex"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" title "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'text'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n// 文本搜索\n// will "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("return")]),t._v(" document with title "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Post One"')]),t._v("\n// "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" there is no "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("more")]),t._v(" posts created\ndb.posts.find"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$text")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$search")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("Post O"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".pretty"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),s("h3",{attrs:{id:"更新"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更新"}},[t._v("#")]),t._v(" 更新")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/oddfar/static/img/MongoDB/mongo-x-usage-5.png",alt:"img"}})]),t._v(" "),s("ul",[s("li",[t._v("使用 "),s("code",[t._v("db.<collection_name>.updateOne(<filter>, <update>, <options>)")]),t._v(" 方法修改一个匹配 "),s("code",[t._v("<filter>")]),t._v(" 条件的文档")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("db.<collection_name>.updateMany(<filter>, <update>, <options>)")]),t._v(" 方法修改所有匹配 "),s("code",[t._v("<filter>")]),t._v(" 条件的文档")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("db.<collection_name>.replaceOne(<filter>, <update>, <options>)")]),t._v(" 方法"),s("strong",[t._v("替换")]),t._v("一个匹配 "),s("code",[t._v("<filter>")]),t._v(" 条件的文档")]),t._v(" "),s("li",[s("code",[t._v("db.<collection_name>.update(查询对象, 新对象)")]),t._v(" 默认情况下会使用新对象替换旧对象")])]),t._v(" "),s("p",[t._v("其中 "),s("code",[t._v("<filter>")]),t._v(" 参数与查询方法中的条件参数用法一致.")]),t._v(" "),s("p",[t._v("如果需要修改指定的属性, 而不是替换需要用“修改操作符”来进行修改")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("$set")]),t._v(" 修改文档中的制定属性")])]),t._v(" "),s("p",[t._v("其中最常用的修改操作符即为"),s("code",[t._v("$set")]),t._v("和"),s("code",[t._v("$unset")]),t._v(",分别表示"),s("strong",[t._v("赋值")]),t._v("和"),s("strong",[t._v("取消赋值")]),t._v(".")]),t._v(" "),s("p",[t._v("先加入一些数据：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.inventory.insertMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"canvas"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35.5")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"journal"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mat"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("85")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("27.9")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("35.5")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mousepad"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("25")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"P"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"notebook"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"P"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8.5")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"planner"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("75")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"postcard"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("45")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("15.25")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sketchbook"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sketch pad"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("95")]),t._v(", size: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" h: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22.85")]),t._v(", w: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30.5")]),t._v(", uom: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("更新数据：")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.inventory.updateOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$set")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size.uom"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cm"')]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"P"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$currentDate")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" lastModified: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ndb.inventory.updateMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$set")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"size.uom"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"in"')]),t._v(", status: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"P"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n        "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$currentDate")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" lastModified: "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[s("code",[t._v("db.<collection_name>.replaceOne()")]),t._v(" 方法替换除 "),s("code",[t._v("_id")]),t._v(" 属性外的"),s("strong",[t._v("所有属性")]),t._v(", 其"),s("code",[t._v("<update>")]),t._v("参数应为一个"),s("strong",[t._v("全新的文档")]),t._v(".")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.inventory.replaceOne"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" item: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"paper"')]),t._v(", instock: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("60")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" warehouse: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),t._v(", qty: "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("40")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v('修改前：\n{ item: "paper", qty: 100, size: { h: 8.5, w: 11, uom: "in" }, status: "D" }')]),t._v(" "),s("p",[t._v('修改完后：\n{  "item" : "paper", "instock" : [ { "warehouse" : "A", "qty" : 60 }, { "warehouse" : "B", "qty" : 40 } ] }')])]),t._v(" "),s("p",[s("strong",[t._v("批量修改")])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("// 默认会修改第一条\ndb.document.update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" userid: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("username: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"guest"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n// 修改所有符合条件的数据\ndb.document.update"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" userid: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"30"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$set")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("username: "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"guest"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("multi: true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"删除"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#删除"}},[t._v("#")]),t._v(" 删除")]),t._v(" "),s("ul",[s("li",[t._v("使用 "),s("code",[t._v("db.collection.deleteMany()")]),t._v(" 方法删除所有匹配的文档.")]),t._v(" "),s("li",[t._v("使用 "),s("code",[t._v("db.collection.deleteOne()")]),t._v(" 方法删除单个匹配的文档.")]),t._v(" "),s("li",[s("code",[t._v("db.collection.drop()")])]),t._v(" "),s("li",[s("code",[t._v("db.dropDatabase()")])])]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[t._v("db.inventory.deleteMany"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" qty "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$lt")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("blockquote",[s("p",[t._v("Delete operations "),s("strong",[t._v("do not drop indexes")]),t._v(", even if deleting all documents from a collection.")]),t._v(" "),s("p",[t._v("一般数据库中的数据都不会真正意义上的删除, 会添加一个字段, 用来表示这个数据是否被删除")])]),t._v(" "),s("h2",{attrs:{id:"参考文章"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[t._v("#")]),t._v(" 参考文章")]),t._v(" "),s("ul",[s("li",[t._v("https://zhenye-na.github.io/2020/01/27/intro-to-mongodb.html")]),t._v(" "),s("li",[t._v("https://www.pdai.tech/md/db/nosql-mongo/mongo-x-usage-1.html")])])],1)}),[],!1,null,null,null);s.default=e.exports}}]);