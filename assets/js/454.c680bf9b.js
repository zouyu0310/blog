(window.webpackJsonp=window.webpackJsonp||[]).push([[454],{1112:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"_69-gateway9527搭建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_69-gateway9527搭建"}},[t._v("#")]),t._v(" 69_Gateway9527搭建")]),t._v(" "),a("p",[t._v("1.新建Module - cloud-gateway-gateway9527")]),t._v(" "),a("p",[t._v("2.POM")]),t._v(" "),a("p",[t._v("3.YML")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("server:\n  port: 9527\n\nspring:\n  application:\n    name: cloud-gateway\n\neureka:\n  instance:\n    hostname: cloud-gateway-service\n  client: #服务提供者provider注册进eureka服务列表内\n    service-url:\n      register-with-eureka: true\n      fetch-registry: true\n      defaultZone: http://eureka7001.com:7001/eureka\n\n")])])]),a("p",[t._v("4.业务类")]),t._v(" "),a("p",[t._v("无")]),t._v(" "),a("p",[t._v("5.主启动类")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("@SpringBootApplication\n@EnableEurekaClient\npublic class GateWayMain9527\n{\n    public static void main(String[] args) {\n        SpringApplication.run(GateWayMain9527.class, args);\n    }\n}\n\n")])])]),a("p",[t._v("6.9527网关如何做路由映射?")]),t._v(" "),a("p",[t._v("cloud-provider-payment8001看看controller的访问地址")]),t._v(" "),a("ul",[a("li",[t._v("get")]),t._v(" "),a("li",[t._v("lb")])]),t._v(" "),a("p",[t._v("我们目前不想暴露8001端口，希望在8001外面套一层9527")]),t._v(" "),a("p",[t._v("7.YML新增网关配置")]),t._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("server")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9527")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spring")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("application")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cloud"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gateway\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#############################新增网关配置###########################")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("cloud")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("gateway")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("routes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" payment_routh "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#payment_route    #路由的ID，没有固定规则但要求唯一，建议配合服务名")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8001")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#匹配后提供服务的路由地址")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#uri: lb://cloud-payment-service #匹配后提供服务的路由地址")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("predicates")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Path=/payment/get/"),a("span",{pre:!0,attrs:{class:"token important"}},[t._v("**")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 断言，路径相匹配的进行路由")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" payment_routh2 "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#payment_route    #路由的ID，没有固定规则但要求唯一，建议配合服务名")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("uri")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//localhost"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("8001")]),t._v("          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#匹配后提供服务的路由地址")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#uri: lb://cloud-payment-service #匹配后提供服务的路由地址")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("predicates")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" Path=/payment/lb/"),a("span",{pre:!0,attrs:{class:"token important"}},[t._v("**")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 断言，路径相匹配的进行路由")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("####################################################################")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("eureka")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("instance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("hostname")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" cloud"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("gateway"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("client")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#服务提供者provider注册进eureka服务列表内")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("service-url")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("register-with-eureka")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("fetch-registry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("defaultZone")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//eureka7001.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("7001/eureka\n\n")])])]),a("p",[t._v("8.测试")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("启动7001\n\n启动8001-cloud-provider-payment8001\n\n启动9527网关\n\n访问说明\n    添加网关前 - http://localhost:8001/payment/get/1\n    添加网关后 - http://localhost:9527/payment/get/1\n    两者访问成功，返回相同结果\n")])])]),a("p",[t._v("最终结果8001和9527都可以访问到接口")])])}),[],!1,null,null,null);a.default=e.exports}}]);