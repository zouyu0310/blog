(window.webpackJsonp=window.webpackJsonp||[]).push([[497],{1164:function(t,a,s){"use strict";s.r(a);var e=s(14),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"redis位图-bitmap"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis位图-bitmap"}},[t._v("#")]),t._v(" Redis位图(bitmap)")]),t._v(" "),a("p",[t._v("一句话：由0和1状态表现的二进制位的bit数组")]),t._v(" "),a("h3",{attrs:{id:"看需求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#看需求"}},[t._v("#")]),t._v(" 看需求：")]),t._v(" "),a("ol",[a("li",[t._v("用户是否登陆过Y、N，比如软件的每日签到功能")]),t._v(" "),a("li",[t._v("电影、广告是否被点击播放过")]),t._v(" "),a("li",[t._v("钉钉打卡上下班，签到统计")])]),t._v(" "),a("h3",{attrs:{id:"是什么"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#是什么"}},[t._v("#")]),t._v(" 是什么?")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/60.zset-bitarrays.jpg",alt:""}})]),t._v(" "),a("p",[t._v("说明：$\\textcolor{red}{用String类型作为底层数据结构实现的一种统计二值状态的数据类型}$")]),t._v(" "),a("p",[t._v("$\\textcolor{red}{位图本质是数组}$，它是基于String数据类型的按位的操作。该数组由多个二进制位组成，每个二进制位都对应一个偏移量（我们称之为一个索引）。")]),t._v(" "),a("p",[t._v("Bitmap支持的最大位数是2^32位，它可以极大的节约存储空间，使用512M内存就可以存储多达42.9亿的字节信息(2^32=4294967296)")]),t._v(" "),a("h3",{attrs:{id:"能干嘛"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#能干嘛"}},[t._v("#")]),t._v(" 能干嘛？")]),t._v(" "),a("p",[t._v("用于状态统计，Y、N类似AtomicBoolean")]),t._v(" "),a("h3",{attrs:{id:"基本命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本命令"}},[t._v("#")]),t._v(" 基本命令")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/61.bitmap%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4.jpg",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_1-setbit-key-offset-value"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-setbit-key-offset-value"}},[t._v("#")]),t._v(" 1.setbit key offset value")]),t._v(" "),a("p",[t._v("setbit 键偏移位 只能零或者1")]),t._v(" "),a("p",[a("strong",[t._v("Bitmap的偏移量从零开始计算的")])]),t._v(" "),a("p",[a("img",{attrs:{src:"images/62.Bitmap-setbit%E7%A4%BA%E6%84%8F%E5%9B%BE.jpg",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"images/63.Bitmap-setbit.jpg",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_2-getbit-key-offset"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-getbit-key-offset"}},[t._v("#")]),t._v(" 2.getbit key offset")]),t._v(" "),a("p",[t._v("获取键偏移位的值")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/64.Bitmap-getbit.jpg",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_3-strlen-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-strlen-key"}},[t._v("#")]),t._v(" 3.strlen key")]),t._v(" "),a("p",[t._v("统计字节数占用多少")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/65.Bitmap-strlen.jpg",alt:""}})]),t._v(" "),a("p",[t._v("不是字符串长度而是占据几个字节，超过8位后自己按照8位一组"),a("strong",[t._v("一byte")]),t._v("再扩容")]),t._v(" "),a("h3",{attrs:{id:"_4-bitcount-key-start-end-byte-bit"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-bitcount-key-start-end-byte-bit"}},[t._v("#")]),t._v(" 4.bitcount key [start end [byte|bit]]")]),t._v(" "),a("p",[t._v("全部键里面包含有1的有多少个")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/66.Bitmap-bitcount.jpg",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"_5-bitop-operation-and-or-xor-not-destkey-key-key"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-bitop-operation-and-or-xor-not-destkey-key-key"}},[t._v("#")]),t._v(" 5.bitop operation(AND|OR|XOR|NOT) destkey key [key ...]")]),t._v(" "),a("p",[t._v("案例：连续2天都签到的用户数量")]),t._v(" "),a("p",[t._v("假如某个网站或者系统，它的用户有1000W，我们可以使用redis的HASH结构和bitmap结构做个用户id和位置的映射")]),t._v(" "),a("p",[a("img",{attrs:{src:"images/67.Bitmap-bitop1.jpg",alt:""}})]),t._v(" "),a("p",[a("img",{attrs:{src:"images/68.Bitmap-bitop2.jpg",alt:""}})])])}),[],!1,null,null,null);a.default=r.exports}}]);